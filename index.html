<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>BadCodeLu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="BadCodeLu">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="BadCodeLu">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BadCodeLu">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="BadCodeLu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">

	
	<form class="search" action="/search/index.html" method="get" accept-charset="utf-8">
		<label>Search</label>
		<input type="text" id="st-search-input" class="st-search-input_my" maxlength="30" placeholder="Search" />
	</form>
	

	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xs3ih.com1.z0.glb.clouddn.com/WechatIMG5.jpeg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">BadCodeLu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">漫漫长夜，写代码时候有你相伴</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/categories/DailyReport">Daily Report</a></li>
				        
							<li><a href="/categories/Life">乱七八糟</a></li>
				        
							<li><a href="/categories/iOS">移动端</a></li>
				        
							<li><a href="/categories/AR">AR学习</a></li>
				        
							<li><a href="/categories/other">其他技术流</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/hehedalulu" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/1043667310/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/wang-lu-lu-51-41" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/HealthKit/" style="font-size: 15px;">-HealthKit</a> <a href="/tags/Objective-C/" style="font-size: 10px;">-Objective-C</a> <a href="/tags/UIImage优化相关/" style="font-size: 10px;">-UIImage优化相关</a> <a href="/tags/hexo/" style="font-size: 15px;">-hexo</a> <a href="/tags/iOS小细节/" style="font-size: 10px;">-iOS小细节</a> <a href="/tags/iOS页面优化相关/" style="font-size: 10px;">-iOS页面优化相关</a> <a href="/tags/java/" style="font-size: 10px;">-java</a> <a href="/tags/mac软件/" style="font-size: 15px;">-mac软件</a> <a href="/tags/plan/" style="font-size: 10px;">-plan</a> <a href="/tags/storyboard/" style="font-size: 10px;">-storyboard</a> <a href="/tags/梦想/" style="font-size: 10px;">-梦想</a> <a href="/tags/深沉的暗恋/" style="font-size: 10px;">-深沉的暗恋</a> <a href="/tags/生活杂记/" style="font-size: 20px;">-生活杂记</a> <a href="/tags/第三方库学习使用/" style="font-size: 10px;">-第三方库学习使用</a> <a href="/tags/CoreMotion/" style="font-size: 10px;">CoreMotion</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/iOS内存管理/" style="font-size: 10px;">iOS内存管理</a> <a href="/tags/iOS学习/" style="font-size: 10px;">iOS学习</a> <a href="/tags/iOS系统的SDK/" style="font-size: 10px;">iOS系统的SDK</a> <a href="/tags/plan/" style="font-size: 10px;">plan</a> <a href="/tags/storyboard/" style="font-size: 10px;">storyboard</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/第三方库学习使用/" style="font-size: 10px;">第三方库学习使用</a>
					</div>
				</section>
				

				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">我是lulu 一个野路子出身的程序员</div>
				</section>
				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">BadCodeLu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xs3ih.com1.z0.glb.clouddn.com/WechatIMG5.jpeg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">BadCodeLu</h1>
			</hgroup>
			
			<p class="header-subtitle">漫漫长夜，写代码时候有你相伴</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/categories/DailyReport">Daily Report</a></li>
		        
					<li><a href="/categories/Life">乱七八糟</a></li>
		        
					<li><a href="/categories/iOS">移动端</a></li>
		        
					<li><a href="/categories/AR">AR学习</a></li>
		        
					<li><a href="/categories/other">其他技术流</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/hehedalulu" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/1043667310/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/wang-lu-lu-51-41" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-2017-1-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/01/2017-1-1/" class="article-date">
  	<time datetime="2017-01-01T06:18:23.000Z" itemprop="datePublished">2017-01-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/01/2017-1-1/">2017.1.1</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/DailyReport/">DailyReport</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-lulu2016年终总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/31/lulu2016年终总结/" class="article-date">
  	<time datetime="2016-12-31T11:55:38.000Z" itemprop="datePublished">2016-12-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/31/lulu2016年终总结/">lulu2016年终总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2016年度总结"><a href="#2016年度总结" class="headerlink" title="2016年度总结"></a>2016年度总结</h1><p> <strong>轰轰烈烈的2016年</strong><br>这一年中发生我生命中很多很重要的事情也长了很多肉 大致可以概括为<br><strong>1. 深爱4年的女朋友的离开</strong><br><strong>2. 被迫出柜</strong><br><strong>3. 学习很多技术</strong><br><strong>4. 加入冰岩</strong></p>
<h2 id="女友的离开"><a href="#女友的离开" class="headerlink" title="女友的离开"></a>女友的离开</h2><p>徐祎璠原本是我打算过完一辈子的人<br>四年的感情 天堂与地狱<br>很多事情已经忘的差不多了<br>我只记得 为了她放弃出国去复读 每个月15个小时的硬座 从中国的最东到最中 那些痛苦漫长压力与不堪的黑夜 一瓶可乐都舍不得买的拮据生活<br>        第二次高考前五天被劈腿 对象是从洛杉矶回来的高中同学<br>        瞒了所有人把志愿偷偷改到武汉 送完iPhone6后莫名复合<br>        散漫放荡的大一生活 第二次劈腿联创安卓组易亚洲后的彻底不回头<br>我忘不了她 我好恨她<br>年初的泡吧放纵约炮，到暴饮暴食，到冲动过头想炸了韵苑。做了很多错事，最后闹到了两边的辅导员和党委书记和警察<br>我没想过会这样，也不知道会这样。就像一头失去理智疯魔的了狮子，整个过程就像一场惊心动魄的梦一样。每一次回忆都是对自己的一次凌迟。<br>但现在想想真的不适合在一起。当时的我太弱小太脆弱，但绝不能被提学校差没前途没未来，她每天小心翼翼的维护着我可怜的自尊。想说不敢说，想鼓励我也会被我曲解成讽刺，双方都很痛苦。</p>
<h1 id="被迫出柜"><a href="#被迫出柜" class="headerlink" title="被迫出柜"></a>被迫出柜</h1><p>我是一个 <strong>无性别意识者</strong><br>在我的世界里，只有强势群体和弱势群体之分，很多女孩子需要被保护，有的男孩子也是。没有什么男权女权的意识吧，都一样。反感 <strong>屌癌</strong> 也不支持过分的 <strong>女权主义</strong>。<br>可出柜这件事情真的改变了我很多。<br>学校这边各种老师和辅导员还好，但我的父母真的是很传统的父母。<br>他们的反应也挺正常的，惊吓，完全不能理解，辱骂我，心灰意冷。然后断了我的经济来源，不理不睬。<br>没什么伤人不伤人吧，已经没感觉了。<br>经历了一场失恋，身体极端到心梗被抢救之后已经没什么感觉了。<br>抑郁了一段时间，天天吃药看心理医生真的很不爽。<br>反正怎么样都没有关系。<br>就是没钱很穷生活很艰难。</p>
<h1 id="学习技术"><a href="#学习技术" class="headerlink" title="学习技术"></a>学习技术</h1><p>真的很穷。<br>非常穷。<br>有一周整整吃了一个星期的热干面。<br>我不敢见人 熟人生人都不想见 把自己关到了实验室里(国际班自己的小机房)<br>闷的时候就开始写iOS 学最难学的Objective-C<br>后来知道可以帮学长学姐写毕设可以赚钱，也不管会不会就接了两个毕设的活：一个安卓的懒人分享闹钟，一个iOS的人脸识别微笑的心情笔记本。讲道理，真是被穷逼疯的。反正糊里糊涂的抄抄改改仿一仿一个月就搞出来了，后来自己都觉得有点不可思议。安卓的那个还拿了毕设的省优。。算我傻两个活起来两千块都不到。<br>之前报联创被刷下来有点不爽 我现在都记着当时联创的队长孟涛在联创内部的大群里说的那句“外校的如果不是很优秀，就不要招了”。<br>接着开始有老师来让我帮他维护一些项目，还给了我一个深圳一家公司的iOS外包。五位数的外包，帮他写代码每个月还有一千块的补贴。莫名其妙的还有学生找我帮他们做课设，还有志愿者网站。虽然我接触编程比较早，高中就有写过html和一些C，但偶尔的爱好并不能说明技术有多好。但是还是硬着头皮在ddl之前都赶出来了。<br>虽然不是纯爱好驱动的，但是这样的压力之下我真的学了很多东西。因为志愿者网站和我自己的博客，学了一点前端，因为毕设和自己的课设学了一点安卓，因为接了一个iOS的大外包，学了很多很多移动端的东西。<br>其实挺不要脸的。<br>分享一下我的 <strong>学习经历</strong> 吧。<br>没有人带我，也没有人教我，所有的技术都是我自己学的。<br>一开始我在淘宝上买了很多黑马，传智播客，极客学院的各种编程速成教学视频，订阅了各种公众号，把图书馆所有移动端技术开发相关的书都借过来了(没钱 图书馆可以借10本书)。最开始学的时候刷了两三个星期看视频，刷完之后自己写，发现基本上还是什么都不会，只是思路理通了。那不会写就看国内一些书上的一些写好的代码，看看改改，但是实际上根本不懂为什么这么写。后来想自己写一些控件一些逻辑也不会写，我就直接给那些书的作者发email。微博，twitter，Facebook私信他们。但是还是不回我。。我就学了python，七爬八爬的把这些大牛的联系方式给爬下来了。然后直接聊，直接问。。后来也是巧神的指点（国内iOS届最有名的男人），才知道原来要多google＋stackoverflow+github…原来要多看国外的视频和官方文档…后来又推翻了之前的所有的学习从头又学习了一遍。。。<br>所以真的很羡慕现在团队里面新人有老人带的氛围。。如果我当年有人愿意带，我也不会吃这么多亏了。<br>我想想……<br>一个人的学习真的很枯燥，但是可以填补当时的自己。<br>我开始混圈，混伯乐在线，混V2EX，各种大神存在的群。成为技术圈的一个小小的键盘侠，认识了很多大牛，也学了很多很酷的技术。<br>莫名其妙的，爬了很多前女友的资料。知道了她换了的各种联系方式。<br>这也算是一个动力吧……<br>大一暑假之前用环信的聊天室和UCloud做了一个超简单的校园教育直播APP，报了一个百度和中科大的互联网的创业夏令营。我也不知道自己是怎么从一万人里筛200人筛出来的，反正十天四星级酒店加包吃包路费挺爽的。哦，对了。结束的时候还拿了一个一万的奖金，还有百度的一个实习。感觉挺好的。</p>
<h1 id="加入冰岩"><a href="#加入冰岩" class="headerlink" title="加入冰岩"></a>加入冰岩</h1><p>今年最开心的事情就是加入冰岩了！！！<br>特别开心！！<br>其实知道冰岩很久了。<br>最开始是我的前女友很喜欢冰岩，14还是15年，她偷偷的来到1006门口，拍了一张照片给我，她告诉我，“你知道么，就在这么小的房间做出来很多很厉害的东西”。查了一些资料，知道这边是一个很酷的地方。<br>后来有关注微博和知乎上一些冰岩相关有意思的事情。<br>后来爬了很多冰岩这边的数据😂，知道了很多很有趣的事情。<br>后来和学姐聊过就来报名了。。<br>其实我之前四月份就有报过，但是当时的iOS组组长陆俊杰和我说，他们人已经很多了。。暂时不需要了。。。。。<br>特别奇幻就这样进了。<br>讲道理，进来之后我是有点失望的。<br>因为可能真的没有我想象中那么酷，技术产品断层有点严重。。我一直以为这里就是最顶尖的大牛的存在着的。</p>
<p>学姐很美，之前很喜欢，但现在好像没有那么喜欢了。<br>cmm脾气有点大，有的时候说话真的有点过分。<br>白云很可爱，和板少在一起挺好的。<br>bird人超好，虽然脾气有点大，情绪也不太稳定，但是人真的超好。<br>菠萝好美，像小妹妹一样，特别有艺术气息。。<br>LL真的超优秀超可爱人超弱智，和她在一起做产品特别开心，我觉得她是现在冰岩最厉害的人。</p>
<p>Hackday认识了柳柳和菠萝。虽然不明白为什么要有程序员的性别歧视，但是被人提起来还是挺不爽的。</p>
<p>其实一开始我也不知道为什么想跑AR和LBS的坑，为什么想做一款校园版的Pokemon。虽然两个月过去了，但其实真正开始seeklight这个项目应该是12月份。我们一直都不知道我们想要的是什么，没有一个明确的产品定位和导向，技术也没有办法达到Pokemon那种水准。游戏化的产品和代码真的很难想很难写，hackday的时候我们为了AR而AR，为了技术而产品，但其实这样很不好。我能清楚的感受到柳柳的力不从心，感受到她的困惑与疲惫，看的出来她并不是很想写游戏策划，也能感受到菠萝对之前hackday设计的图的付诸东流的细微不满。</p>
<p>时间长了，我们整个团队的士气都很低落，甚至说对自己的产品都很没有信心。因为其实一直到现在我们都没有想好要往什么方向去发展去做。我们现在的定位是呼吁所有的学生走出宿舍，去学校的各个角落去寻找光体，用每天的步数去加速光体的生成。这是一款校园习惯养成偏游戏化的APP，但其实这都不是刚需，游戏从来都不是刚需，我们让学生们走出宿舍去记住学校的景点这也不是刚需。迪迪说的没错，AR的感觉总是一阵一阵的。<br>但是我们为什么要做这个我们自己都没有信心的游戏化APP呢？</p>
<p>我们的用户都是学生，他们凭什么一定要走出宿舍寻找实景捕捉光体，而不是在宿舍打游戏呢？是因为实景下面有着这个学校的秘密吗？我决定我们可以朝着这个方向发展一下，每一个实景的光体下面都有一个学校的小秘密，正大门的毛爷爷雕像，诡异的南一楼，看似正经的东九西十二教学楼，每个光体的下面都有着一段这个学校的记忆。我们急匆匆的跑到这个校园秘密神秘点，发现了这个神秘的光体下面的秘密之后，我们可以通过AR截屏甚至于AR录屏的方式去分享到朋友圈，我觉得这样才能促进大家出去跑，不管在学校的哪里都想打开我们的APP看一看附近有没有什么遗漏的校园秘密，这样才能促进用户，带着手机举着手机打开我们的APP去在校园里面转，谁都不知道在哪个实景底下藏着什么。发现秘密最多的人就是这个学校的人气王。</p>
<p>另外我觉得我们滤镜的这个点子也挺好的，寻找的过程有一个APP内部明显的视觉变化，我们通过寻找到实景的多少去累计滤镜的进程，不同的滤镜在朋友圈的分享效果是很棒的，特定的滤镜下看到的东西是不同的！！怎么样？？？</p>
<p>另一方面，我们也可以往习惯养成这个方向发展。那我们到底要怎么样做我们的习惯养成呢？是像我要当学霸那样吗？每一天六点在东九湖畔设一个实景的flag，让大家基于AR去打卡，并用LBS去限制用户真实打卡，真正的养成用户真正的优秀的习惯吗？我们已经有了我们自己用户的步数系统，是否是去促进去督促用户再去形成一些优秀的习惯呢？我们到底怎么样才能用AR和LBS的手段去促进用户形成习惯去打开我们的APP呢？这边也可以养成。都挺好的</p>
<p>不管怎么说，我很喜欢我们项目组的每一个同学，我希望她们能对自己有信心。菠萝真的超级优秀，她画的图真的超好看。我对设计的夸赞甚至被人嘲笑说“好像从来没有见过设计一样”，(你们难道不知道自己真的超级屌超级棒吗，真的很好啊！！)柳柳真的很专业，真的很有大佬的感觉，一直到现在我和柳柳讲话都有一点压力，生怕自己的菜鸡给大佬拖了后腿。</p>
<p>说句题外话，柳柳真的是一个超级屌超级强超级独立一个的人。我之前甚至觉得她好美，甚至以为自己喜欢上她了。。和雪君姐姐聊完之后发现这些都是错觉哈哈，可能是她太优秀太强势了，但是真的没遇到一个经验丰富有很厉害的产经啊，和她一起做项目是我的荣幸。虽然我喜欢黑她但是我是真的服她。我是一个怪人，她能够忍受这么多，真的很对不起她。我也不知道怎么办才好，我真的有的时候说话很过分很极端很不过脑我自己也很懊悔。如果以后我成功了，我一定会好好报答她的。。</p>
<h2 id="换个话题吧"><a href="#换个话题吧" class="headerlink" title="换个话题吧"></a>换个话题吧</h2><h2 id="About-Bingyan"><a href="#About-Bingyan" class="headerlink" title="About Bingyan"></a>About Bingyan</h2><p>发生了一些事情，柳柳不得不留下来去承担这份责任去带领冰岩。虽然她说话很幼稚，但是她的思想一点都不幼稚，牺牲了去腾讯的机会，明明下学期在学校一节课都没有，却要留在学校呆在冰岩带着新人。这学期她一个人带着五个新人，基本上带着团队所有的项目。我和她一起做项目的时候这些都看在眼里的。。真的蛮辛苦的。。最佳冰岩人这个称号应该给柳柳吧。我想，以后她的压力应该会更大吧。怎么样和魏老师一起带领冰岩走向更好的未来，如果带着这么多人一起前进，一起努力。魏老师太偏意识流了，产品的思维感觉还差一点吧。这样看柳柳压力好大。</p>
<p>最后</p>
<p>之前有和雪君姐姐聊过现在的冰岩。影响最深的是“现在团队没有一个有狼性的人，很难去创业去成功”。</p>
<p>是啊，说一句无脑喷的话，冰岩现在已经变成一个BAT的预备队了。我也一直很反感这种，难道大佬存在的意义就是二十万把自己批发给BAT？然后去各种成功的校友分享会上分享面试经验吗？？难道冰岩不是一个实现梦想的地方？我们是不是再也做不出像“恋爱笔记”“二手街”“校园通”这样的产品了？为什么冰岩的声音在学校越来越小了？我们加入冰岩难道就是为了在自己的简历上面添上浓墨重彩的一笔？？？难道一定要这么功利化吗！！！自己的产品不做完就去实习去离开！！好像留下一个半成品虽然遗憾但是已经达到了自己的目的一样！！！</p>
<p>我知道这里不是一个纯技术团队。这里是一个互联网团队，我们和联创和点不一样的地方是我们可以做出我们想做的东西，我们可以把自己的idea落地去实现，但是我们不应该把这个过程当做一个滋润自己简历的过程。这里，曾经是我幻想中的乌托邦啊！做一个东西，应该坚持到底，不应该因为要实习因为各种其他的原因就轻易放弃。为什么那么多项目都腹死胎中？为什么那么多产品没上线就半路砍掉？难道全部都因为不是刚需没有意义就砍掉吗？</p>
<p>作为产品，作为程序员，作为设计，你做的产品，最后死掉了，最后成为了你简历上辉煌的一笔这他妈很光荣吗？为什么运营组没有可以运营的产品？真的是因为没有产品能到那一步吗？为什么？为什么项目组的人没有坚持？为什么别人不看好别人不认同你自己也放弃了！阿西吧！！很烦啊。</p>
<p>妈的我才不是这种人。<br>我一定要把自己的项目做大做火，就算只有我一个人，我也会坚持下去的。<br>别人全他妈在放屁</p>
<p>满纸荒唐言，各位看官见效了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生活杂记/">-生活杂记</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Life/">Life</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS下帧动画相关性能调优" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/27/iOS下帧动画相关性能调优/" class="article-date">
  	<time datetime="2016-12-27T13:32:52.000Z" itemprop="datePublished">2016-12-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/27/iOS下帧动画相关性能调优/">iOS下帧动画相关性能调优</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近做到很多和帧动画相关的东西 总结一下UIImage相关</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UIImage优化相关/">-UIImage优化相关</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/iOS/">iOS</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-AR开发中的一些哭笑不得的bug" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/24/AR开发中的一些哭笑不得的bug/" class="article-date">
  	<time datetime="2016-11-24T12:05:04.000Z" itemprop="datePublished">2016-11-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/24/AR开发中的一些哭笑不得的bug/">AR开发中的一些哭笑不得的bug</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/AR/">AR</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS中各种传感器使用的介绍与教程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/26/iOS中各种传感器使用的介绍与教程/" class="article-date">
  	<time datetime="2016-10-26T04:43:42.000Z" itemprop="datePublished">2016-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/26/iOS中各种传感器使用的介绍与教程/">iOS中各种传感器使用的介绍与教程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="all-by-BadCodeLu-转载请注明出处"><a href="#all-by-BadCodeLu-转载请注明出处" class="headerlink" title="all by BadCodeLu 转载请注明出处"></a>all by BadCodeLu 转载请注明出处</h3><p>最近有做到调用系统底层的一些SDK，在iOS10中，我们已知的传感器有<br>环境光传感器 （调节屏幕的亮度）<br>距离传感器(打电话自动黑屏)<br>磁力计传感器（感应周边的磁场）<br>内部温度传感器（提醒用户降温 防止损伤设备）<br>湿度传感器<br>（上面的都是不常用的 也就是说并没有什么卵用的 下面的比较有用<br>陀螺仪（感应设备的的平衡 或者说是持握方式）（赛车类游戏 重力弹球）<br>加速器 (感受设备的运动 摇一摇 记步器)</p>
<p>介绍几个吧</p>
<h3 id="1-距离传感器"><a href="#1-距离传感器" class="headerlink" title="1.距离传感器"></a>1.距离传感器</h3><p>距离传感器是通过添加观察者 监听通知来实现的<br>通知的名称是 UIDeviceProximityStateDidChangeNotification<br>监听的状态是 [UIDevice currentDevice].proximityState<br>使用的代码是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // [UIApplication sharedApplication].proximitySensingEnabled = YES;</span><br><span class="line">    [UIDevice currentDevice].proximityMonitoringEnabled = YES;</span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(proximityStateDidChange) name:UIDeviceProximityStateDidChangeNotification object:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)proximityStateDidChange</span><br><span class="line">&#123;</span><br><span class="line">    if ([UIDevice currentDevice].proximityState) &#123;</span><br><span class="line">        NSLog(@&quot;手机靠近&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;手机离开&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="加速度传感器和陀螺仪"><a href="#加速度传感器和陀螺仪" class="headerlink" title="加速度传感器和陀螺仪"></a>加速度传感器和陀螺仪</h4><p>要做加速度传感器和陀螺仪相关<br>我们需要了解CoreMotion.Framework这个框架<br>这个框架不仅仅提供给你获得实时的加速度值和旋转速度值，更重要的是，苹果在其中集成了很多算法，可以直接给你输出把重力加速度分量剥离的加速度，省去你的高通滤波操作，以及提供给你一个专门的设备的三维位置信息。<br>CoreMotion框架的使用</p>
<h2 id="基本数据"><a href="#基本数据" class="headerlink" title="基本数据"></a>基本数据</h2><p>加速度值      CMAccelerometerData<br>陀螺仪值      CMGyroData<br>设备motion值  CMDeviceMotion<br>  设备的motion值是通过加速度和旋转速度进行变换算出来的<br>  CMDeviceMotion的属性<br>      attitude：手机在当前空间的位置和姿势<br>      gravity：重力信息，重力加速度矢量在当前设备的参考坐标系中的表达<br>      userAcceleration：加速度信息<br>      rotationRate：即时的旋转速率，是陀螺仪的输出</p>
<h2 id="使用的步骤"><a href="#使用的步骤" class="headerlink" title="使用的步骤"></a>使用的步骤</h2><ol>
<li>初始化CMMotionManager管理对象</li>
<li>调用管理对象的对象方法获取数据，有2种方式</li>
<li>处理数据</li>
<li>当你不需要使用的时候，停止获取数据<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(void)stopAccelerometerUpdates;//停止获取加速度计数据</span><br><span class="line">-(void)stopGyroUpdates;//停止获取陀螺仪数据</span><br><span class="line">-(void)stopDeviceMotionUpdates;//停止获取设备motion数据</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="获取数据的两种方式"><a href="#获取数据的两种方式" class="headerlink" title="获取数据的两种方式"></a>获取数据的两种方式</h2><p>Push方式：<br>提供一个线程管理器NSOperationQueue和一个回调Block，CoreMotion自动在每一个采样数据到来的时候回调这个Block，进行处理。在这种情况下，Block中的操作会在你自己的主线程内执行。<br>Pull方式：<br>你必须主动去向CMMotionManager要数据，这个数据就是最近一次的采样数据。你不去要，CMMotionManager就不会给你。</p>
<h3 id="2-加速度传感器"><a href="#2-加速度传感器" class="headerlink" title="2.加速度传感器"></a>2.加速度传感器</h3><p>加速器传感器的读取其实还是蛮酷的 监听的方式是通过设置代理实现的 它能够监测设备在xyz轴上不同的加速度情况<br>具体的实现逻辑是</p>
<ol>
<li>获取加速器的单例对象<br><code>UIAccelerometer *accelerometer = [UIAccelerometer sharedAccelerometer];</code></li>
<li>获取加速器的代理对象<br><code>accelerometer.delegate = self;</code></li>
<li>设置采样间隔<br><code>accelerometer.updateInterval = 0.3;</code></li>
<li>实现代理相关的方法 监听数据(分为pull和push两种不同的方法)<br><code>- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration;</code></li>
</ol>
<p>使用起来的代码是这样的</p>
<ol>
<li><p>加速度使用pull方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (void)useAccelerometerPull&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.motionManager = manager;</span><br><span class="line">    //判断加速度计可不可用，判断加速度计是否开启</span><br><span class="line">    if ([manager isAccelerometerAvailable] &amp;&amp; [manager isAccelerometerActive])&#123;</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.accelerometerUpdateInterval = 0.01;</span><br><span class="line">        //开始更新，后台线程开始运行。这是Pull方式。</span><br><span class="line">        [manager startAccelerometerUpdates];</span><br><span class="line">    &#125;</span><br><span class="line">    //获取并处理加速度计数据</span><br><span class="line">    CMAccelerometerData *newestAccel = self.motionManager.accelerometerData;</span><br><span class="line">    NSLog(@&quot;X = %.04f&quot;,newestAccel.acceleration.x);</span><br><span class="line">    NSLog(@&quot;Y = %.04f&quot;,newestAccel.acceleration.y);</span><br><span class="line">    NSLog(@&quot;Z = %.04f&quot;,newestAccel.acceleration.z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>加速度使用push方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (void)useAccelerometerPush&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.motionManager = manager;</span><br><span class="line">    //判断加速度计可不可用，判断加速度计是否开启</span><br><span class="line">    if ([manager isAccelerometerAvailable] &amp;&amp; [manager isAccelerometerActive])&#123;</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.accelerometerUpdateInterval = 0.01;</span><br><span class="line">        NSOperationQueue *queue = [[NSOperationQueue alloc] init];</span><br><span class="line">        //Push方式获取和处理数据</span><br><span class="line">        [manager startAccelerometerUpdatesToQueue:queue</span><br><span class="line">                 withHandler:^(CMAccelerometerData *accelerometerData, NSError *error)</span><br><span class="line">         &#123;</span><br><span class="line">             NSLog(@&quot;X = %.04f&quot;,accelerometerData.acceleration.x);</span><br><span class="line">             NSLog(@&quot;Y = %.04f&quot;,accelerometerData.acceleration.y);</span><br><span class="line">             NSLog(@&quot;Z = %.04f&quot;,accelerometerData.acceleration.z);</span><br><span class="line">         &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-陀螺仪传感器"><a href="#2-陀螺仪传感器" class="headerlink" title="2.陀螺仪传感器"></a>2.陀螺仪传感器</h3><p>陀螺仪传感器使用起来与加速度传感器使用起来是相似的<br>具体代码实现如下</p>
<ol>
<li><p>陀螺仪实现用pull方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//pull的方法实现陀螺仪</span><br><span class="line">- (void)useGyroPull&#123;</span><br><span class="line"></span><br><span class="line">    // 1.判断加速计是否可用</span><br><span class="line">    if (!self.Gyromanager.isAccelerometerAvailable) &#123;</span><br><span class="line">        NSLog(@&quot;加速计不可用，请跟换手机&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 2.开始采集数据</span><br><span class="line">    [self.Gyromanager startAccelerometerUpdates];</span><br><span class="line"></span><br><span class="line">    CMRotationRate rotationRate = self.Gyromanager.gyroData.rotationRate;</span><br><span class="line">    NSLog(@&quot;x:%f-y:%f-z:%f&quot;,rotationRate.x, rotationRate.y, rotationRate.z);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>陀螺仪的实现用push方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- (void)useGyroPush&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.Gyromanager = manager;</span><br><span class="line">    //判断陀螺仪可不可以，判断陀螺仪是不是开启</span><br><span class="line">    if ([manager isGyroAvailable] &amp;&amp; [manager isGyroActive])&#123;</span><br><span class="line"></span><br><span class="line">        NSOperationQueue *queue = [[NSOperationQueue alloc] init];</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.gyroUpdateInterval = 0.01;</span><br><span class="line">        //Push方式获取和处理数据</span><br><span class="line">        [manager startGyroUpdatesToQueue:queue</span><br><span class="line">                             withHandler:^(CMGyroData *gyroData, NSError *error)</span><br><span class="line">         &#123;</span><br><span class="line">             NSLog(@&quot;Gyro Rotation x = %.04f&quot;, gyroData.rotationRate.x);</span><br><span class="line">             NSLog(@&quot;Gyro Rotation y = %.04f&quot;, gyroData.rotationRate.y);</span><br><span class="line">             NSLog(@&quot;Gyro Rotation z = %.04f&quot;, gyroData.rotationRate.z);</span><br><span class="line">         &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><p>push的使用就是利用一个block 不断的回调获取的值 通过isAccelerometerAvailable这个属性来判断能否获取值 但是在官方文档中 isAccelerometerAvailable这个方法只有getter的方法 是没有setter的方法的 所以如果我们想要自己停止获取传感器的值 就要另加一个bool类型的参数自己传进去 当然也可以利用多线程进行时间的的限制 repeats设置成1次就好了 但是还是有这样那样的问题 如果大家有什么好的可以控制传感器进程的方法请给我评论哦 我会认真的看的</p>
<h5 id="以上的demo已上传到github上面-BadCodeLu的github的demo链接"><a href="#以上的demo已上传到github上面-BadCodeLu的github的demo链接" class="headerlink" title="以上的demo已上传到github上面 BadCodeLu的github的demo链接"></a>以上的demo已上传到github上面 <a href="https://github.com/hehedalulu/SensorIniOS/tree/master" target="_blank" rel="external">BadCodeLu的github的demo链接</a></h5>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreMotion/">CoreMotion</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS系统的SDK/">iOS系统的SDK</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/iOS/">iOS</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-HealthKit的数据读取" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/21/HealthKit的数据读取/" class="article-date">
  	<time datetime="2016-10-21T09:27:30.000Z" itemprop="datePublished">2016-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/21/HealthKit的数据读取/">HealthKit的数据读取</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="最近pm突发奇想-因为iOS读取HealthKit的数据会很方便-所以想要用HealthKit的数据做一读取步数-存储步数-向支付宝的蚂蚁森林一样增加EXP-此处好想黑安卓一把哈哈哈-言归正传-上次翻译了一篇Swift版本的-决定自己撸一遍Objective-C版本的-留着方便以后再次使用。"><a href="#最近pm突发奇想-因为iOS读取HealthKit的数据会很方便-所以想要用HealthKit的数据做一读取步数-存储步数-向支付宝的蚂蚁森林一样增加EXP-此处好想黑安卓一把哈哈哈-言归正传-上次翻译了一篇Swift版本的-决定自己撸一遍Objective-C版本的-留着方便以后再次使用。" class="headerlink" title="最近pm突发奇想 因为iOS读取HealthKit的数据会很方便 所以想要用HealthKit的数据做一读取步数 存储步数 向支付宝的蚂蚁森林一样增加EXP 此处好想黑安卓一把哈哈哈 言归正传 上次翻译了一篇Swift版本的 决定自己撸一遍Objective-C版本的 留着方便以后再次使用。"></a>最近pm突发奇想 因为iOS读取HealthKit的数据会很方便 所以想要用HealthKit的数据做一读取步数 存储步数 向支付宝的蚂蚁森林一样增加EXP 此处好想黑安卓一把哈哈哈 言归正传 上次翻译了一篇Swift版本的 决定自己撸一遍Objective-C版本的 留着方便以后再次使用。</h2><p>在iOS中 统计步数信息不许用我们通过自己去实现 iOS自带的健康app就已经提供好了数据 就像我之前翻译的那篇文章一样 HealthKit里面所有的数据都存储在HealthStore里面<br>想要深入的话 大家可以阅读<healthkit healthkit.h="">这个框架<br>我这里实在ViewController里面实现的 我看了一下其他人的介绍 其实好像更加建议吧数据权限的读取放在AppDelegate里面</healthkit></p>
<h4 id="First-Step-在project文件的Capabilities里打开HealthKit的选项"><a href="#First-Step-在project文件的Capabilities里打开HealthKit的选项" class="headerlink" title="First Step 在project文件的Capabilities里打开HealthKit的选项"></a>First Step 在project文件的Capabilities里打开HealthKit的选项</h4><p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-10-21%20%E4%B8%8B%E5%8D%888.34.45.png" alt=""></p>
<h4 id="Second-Step-创建一个HKHealthStore的实例来访问HealthKit-Store"><a href="#Second-Step-创建一个HKHealthStore的实例来访问HealthKit-Store" class="headerlink" title="Second Step 创建一个HKHealthStore的实例来访问HealthKit Store"></a>Second Step 创建一个HKHealthStore的实例来访问HealthKit Store</h4><pre><code>在.h文件中添加
` @property(nonatomic,strong) HKHealthStore *HealthStore`

在访问HealthStore里面的数据之前 你必须要首先请求用户的许可 所以你必须要添加这样一段代码
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    //先判断设备支不支持HealthKit</span><br><span class="line">    if(![HKHealthStore isHealthDataAvailable])&#123;</span><br><span class="line">      NSLog&quot;不支持HealthKit&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //创建HealthStore对象</span><br><span class="line">    self.healthStore = [[HKHealthStore alloc]init];</span><br><span class="line">    //设置需要获取的权限 如果想用其他数据可以写别的type</span><br><span class="line">    HKObjectType *stepType = [HKObjectType quantityTypeForIdentifier:HKQuantityTypeIdentifierStepCount];  </span><br><span class="line">    NSSet *healthSet = [NSSet setWithObjects:stepType,nil];</span><br><span class="line">    //用一个block来实现权限的获取</span><br><span class="line">    [self.healthStore requestAuthorizationToShareTypes:nil readTypes:healthSet completion:^(BOOL success, NSError * _Nullable error) &#123;  </span><br><span class="line">    if (success) &#123;  </span><br><span class="line">        [self ReadStep];  </span><br><span class="line">    &#125;  </span><br><span class="line">    else  </span><br><span class="line">    &#123;  </span><br><span class="line">        NSLog@&quot;获取步数权限失败&quot;;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</code></pre><h3 id="Third-Step-用HKSample采用读取步数"><a href="#Third-Step-用HKSample采用读取步数" class="headerlink" title="Third Step 用HKSample采用读取步数"></a>Third Step 用HKSample采用读取步数</h3><p>   在ReadStep中读取步数<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">  -(void)ReadStep&#123;</span><br><span class="line">  HKSampleType ＊sampleType = [HKQuantityType quantityTypeForIdentifier: HKQuantityTypeIdentifierStepCount];</span><br><span class="line">  //将healthStore的结果排序</span><br><span class="line">  NSSortDescriptor *start = [NSSortDescriptor sortDescriptionWithKey:HKSampleSortIdentifierStartDate ascending:NO];</span><br><span class="line">  NSSortDescriptor *end = [NSSortDescriptor sortDescriptorWithKey:HKSampleSortIdentifierEndDate ascending:NO];</span><br><span class="line">  //获取事件</span><br><span class="line">  NSDate *now = [NSDate date];  </span><br><span class="line">  NSCalendar *calender = [NSCalendar currentCalendar];  </span><br><span class="line">  NSUInteger unitFlags = NSCalendarUnitYear | NSCalendarUnitMonth | NSCalendarUnitDay | NSCalendarUnitHour | NSCalendarUnitMinute | NSCalendarUnitSecond;  </span><br><span class="line">  NSDateComponents *dateComponent = [calender components:unitFlags fromDate:now];  </span><br><span class="line">  int hour = (int)[dateComponent hour];       int minute = (int)[dateComponent minute];  </span><br><span class="line">  int second = (int)[dateComponent second];  </span><br><span class="line">  NSDate *nowDay = [NSDate dateWithTimeIntervalSinceNow:  - (hour*3600 + minute * 60 + second) ];  </span><br><span class="line">  //时间结果与想象中不同是因为它显示的是0区  </span><br><span class="line">  NSLog(@&quot;今天%@&quot;,nowDay);  </span><br><span class="line">  NSDate *nextDay = [NSDate dateWithTimeIntervalSinceNow:  - (hour*3600 + minute * 60 + second)  + 86400];  </span><br><span class="line">  NSLog(@&quot;明天%@&quot;,nextDay);  </span><br><span class="line">  NSPredicate *predicate = [HKQuery predicateForSamplesWithStartDate:nowDay endDate:nextDay options:(HKQueryOptionNone)];</span><br><span class="line"></span><br><span class="line">  /*</span><br><span class="line">  查询的基类是HKQuery，这是一个抽象类，能够实现每一种查询目标，这里我们需要查询的步数是一个HKSample类所以对应的查询类是HKSampleQuery。下面的limit参数传1表示查询最近一条数据，查询多条数据只要设置limit的参数值就可以了</span><br><span class="line">  */  </span><br><span class="line">  HKSampleQuery *sampleQuery = [[HKSampleQuery alloc]initWithSampleType:sampleType predicate:predicate limit:0 sortDescriptors:@[start,end] resultsHandler:^(HKSampleQuery * _Nonnull query, NSArray&lt;__kindof HKSample *&gt; * _Nullable results, NSError * _Nullable error) &#123;  </span><br><span class="line">    //设置一个int型变量来作为步数统计  </span><br><span class="line">    int allStepCount = 0;  </span><br><span class="line">    for (int i = 0; i &lt; results.count; i ++) &#123;  </span><br><span class="line">        //把结果转换为字符串类型  </span><br><span class="line">        HKQuantitySample *result = results[i];  </span><br><span class="line">        HKQuantity *quantity = result.quantity;  </span><br><span class="line">        NSMutableString *stepCount = (NSMutableString *)quantity;  </span><br><span class="line">        NSString *stepStr =[ NSString stringWithFormat:@&quot;%@&quot;,stepCount];  </span><br><span class="line">        //获取51 count此类字符串前面的数字  </span><br><span class="line">        NSString *str = [stepStr componentsSeparatedByString:@&quot; &quot;][0];  </span><br><span class="line">        int stepNum = [str intValue];  </span><br><span class="line">        NSLog(@&quot;%d&quot;,stepNum);  </span><br><span class="line">        //把一天中所有时间段中的步数加到一起  </span><br><span class="line">        allStepCount = allStepCount + stepNum;  </span><br><span class="line">    &#125;  </span><br><span class="line">    //查询要放在多线程中进行，如果要对UI进行刷新，要回到主线程  </span><br><span class="line">&#125;];  </span><br><span class="line">//执行查询  </span><br><span class="line">[self.healthStore executeQuery:sampleQuery];  </span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HealthKit/">-HealthKit</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/iOS/">iOS</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-（转）shadowsocks使用教程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/24/（转）shadowsocks使用教程/" class="article-date">
  	<time datetime="2016-08-24T09:38:31.000Z" itemprop="datePublished">2016-08-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/24/（转）shadowsocks使用教程/">（转）shadowsocks图文使用教程 </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此文为转载，因原网站被墙，广大亲朋好友为翻墙求助于我，秉着服务大众的心，希望可以给他人一些帮助</p>
<h5 id="Shadowsocks科学上网图文教程"><a href="#Shadowsocks科学上网图文教程" class="headerlink" title="Shadowsocks科学上网图文教程"></a>Shadowsocks科学上网图文教程</h5><p>SS的全称是Shadowsocks，是一种轻量级的加密的socks5网络代理，经本人测试速度比VPN快很多，观看YouTube视频非常流畅，是迄今为止最快的科学工具。下面分别介绍在Windows, Mac OS X, Linux, iOS, Android等系统下怎样使用Shadowsocks科学上网。</p>
<h3 id="1-获取SS账号"><a href="#1-获取SS账号" class="headerlink" title="1.获取SS账号"></a>1.获取SS账号</h3><p>首先要有一个Shadowsocks账号（SS账号）。没有SS账号？新浪微博关注 @SS账号 。或者到 <a href="https://www.ss-link.me/" target="_blank" rel="external">www.ss-link.me</a>  获取免费的试用SS账号。</p>
<p>另外，在开始配置之前和配置之后，可以用ip111.cn这样验证一下能否科学上网，用什么方式科学上网的。</p>
<h3 id="2-Windows系统"><a href="#2-Windows系统" class="headerlink" title="2. Windows系统"></a>2. Windows系统</h3><p>到  <a href="https://pan.baidu.com/s/1i58vwB7" target="_blank" rel="external">https://pan.baidu.com/s/1i58vwB7</a>  下载SS客户端软件，任何一个即可。下载完成后解压缩，建议把可执行文件拷贝到一个固定的目录下，比如D:\SS\ 。</p>
<p>双击运行程序，在Windows右下角的图标区域就会多一个像纸飞机一样的图标，这个就是客户端程序，如下图：<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/ss-icon.png" alt="ss-icon"></p>
<p>鼠标右键点击这个纸飞机图标，会出现客户端的主菜单，如下图：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/win-ss.png" alt="win-ss"></p>
<p>把SS账号的二维码图片显示在电脑上，在Windows的SS客户端上（注意：不是手机）点击“服务器选择”，“扫描屏幕上的二维码”， 客户端软件会识别屏幕上的二维码自动配置（电脑不需要有摄像头）</p>
<p>然后点击“确定”回到主菜单，选择“启用代理”和“开机启动”，让这两项前面都有对号，也就是选择上，这样客户端就配置好了。</p>
<p>在主菜单里面，点击代理模式，可以选择PAC模式或者全局模式，前者的意思是只有访问被墙的网站才通过SS账号访问，国内网站和国外没有被墙的网站不通过SS账号。全局模式则是所有访问都走SS。</p>
<p>推荐使用Firefox浏览器，打开选项，高级，网络，设置，如下图配置。注意四个红圈。</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/firefox-ss2.png" alt="firefox-ss"></p>
<p>现在就可以科学上网了，访问 <a href="http://ip111.cn" target="_blank" rel="external">http://ip111.cn</a>  验证一下吧。</p>
<ol>
<li>Mac OS 系统</li>
</ol>
<p>到 <a href="https://pan.baidu.com/s/1i58vwB7" target="_blank" rel="external">https://pan.baidu.com/s/1i58vwB7</a> 下载Mac OS的客户端程序ShadowsocksX并安装运行。主界面如下：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/macselect.png" alt="macselect"></p>
<p>把二维码显示在屏幕上，点击“从屏幕上扫描二维码…”，即可识别屏幕上的二维码自动配置。</p>
<p>点击“打开Shadowsocks”开启SS，然后就可以科学上网了，访问<a href="http://ip111.cn" target="_blank" rel="external">http://ip111.cn</a>  测试一下吧。</p>
<ol>
<li>iOS系统(苹果手机)</li>
</ol>
<p>iOS无需越狱，可以安装ShadowRocket或者Surge，任何一个都可以。ShadowRocket价格便宜并且使用方便，主界面如下，点击左上角的方框可以扫描SS账号的二维码，然后点击”Connected”后面的开关即可科学上网。有时Settings下面的Global Routing需要选择Proxy。Settings下面的On Demand要关闭，Auto Close也不启用，否则会出现Shadowrocket无法断开的情况。</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/shadowrocket-169x300.png" alt="shadowrocket"></p>
<ol>
<li>Android系统</li>
</ol>
<p>下载并安装 <a href="https://pan.baidu.com/s/1i58vwB7" target="_blank" rel="external">https://pan.baidu.com/s/1i58vwB7</a> 这里的两个软件，一个是Android SS客户端，一个是扫描二维码需要的软件。两个软件都要安装。运行SS客户端，主界面如下：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/android-ss-169x300.jpg" alt="android-ss"></p>
<p>点击左上角的纸飞机标志，然后分别点击“添加配置文件”，“扫描二维码”，出现扫描界面，用手机扫描一下SS账号对应的二维码图片就配置好了。再点击“路由”选择“绕过局域网及中国大陆地址”，最后点击右上角的“关闭/打开”按钮开启和关闭SS。然后就可以科学上网了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac软件/">-mac软件</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/other/">other</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-抑郁与负能量" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/15/抑郁与负能量/" class="article-date">
  	<time datetime="2016-07-15T12:35:26.000Z" itemprop="datePublished">2016-07-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/15/抑郁与负能量/">抑郁与负能量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="抑郁？"><a href="#抑郁？" class="headerlink" title="抑郁？"></a>抑郁？</h2><p>  感觉自己抑郁有一阵子了，非常抵触与熟人之间的沟通。很多时候宁可与陌生人交谈都不愿意与熟人进行眼神沟通。生活压力大，对人生感到迷茫，在孤独的时间游身太久了，自己都忘了自己应该是什么样的人了。<br>  是什么会让一个天生活跃的人变的如此抑郁呢？或许冷漠与黑暗是我原来的属性，但这个浮躁的世界太喜欢活跃的人了，也许我应要变得合群变得外向变得开放。有的时候想想这样的人也真是可笑。为什么自己不能是阴郁的是孤独的呢？人生来孤独，我们来到这个世界上的时候是孤身一人的，怎么会有一个人能比你自己还要更加了解你自己呢？别人不能对你所处之境感同身受，不会明白你在想什么，也不会知道你是什么样的。他们只会用他们那般残缺的带着偏见的眼神去打量你。经历了一段失败的感情之后我明白一个道理，一个人绝对不可能完全感受到另一个人的感受。你痛你受伤在别人眼里只是一件既定的客观事实，他们只能在自己的角度来观察。一个人和另一个人之间是两个不同的小宇宙，或许你们会有交集，相处时间久了之后或许会成为并集，但是绝对不会是相等的。如果强行的进行匹配，进行相等的切割，那么剩下的只会是血与泪，而不是幸福的火花。<br>  我把自己关在实验室已经三个多月了，从一开始的不知所措到后来找到可以安身立命的事业，好像一瞬间变老了很多。游荡的久了，人也渐渐的变质了，感觉自己的思想也变得偏执与不堪。是受到黑暗的侵蚀了么？我不知道。<br>  也许每一个人都会在人生的每一个阶段迷失自己，这段时间可能很长，也可能很短，可能是短短的几天，也可能是漫长的一生。但我们曾经都渴望过要以积极的心态活着不是么？就算这个不公的世界给自己带来了多少失意，但是我们还是渴望获得快乐的活着不是么？也许这个世界对我们展现的是不友好，但我们也不应该分裂的排斥自己不是么？<br>  经常的经常，我还是会想起你。但事与愿违，缘分到这里就结束了。曾经那么多次内心的挣扎，现实却打了你一记耳光。不断的做着无用功，却始终相信这些功可能会以另一种光和热的形式展现。多么可笑。<br>  还是继续努力吧，希望能与一群优秀的人并肩。一个人可以走的很快，可以一群人才可以走的很远。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生活杂记/">-生活杂记</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Life/">Life</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-在HealthKit中使用Sleep-Analysis" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/08/在HealthKit中使用Sleep-Analysis/" class="article-date">
  	<time datetime="2016-07-08T01:03:08.000Z" itemprop="datePublished">2016-07-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/08/在HealthKit中使用Sleep-Analysis/"> 在HealthKit中使用Sleep Analysis</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="在HealthKit中使用Sleep-Analysis"><a href="#在HealthKit中使用Sleep-Analysis" class="headerlink" title="在HealthKit中使用Sleep Analysis"></a>在HealthKit中使用Sleep Analysis</h1><h2 id="原作者Anushk-Mittal-译CherryWang"><a href="#原作者Anushk-Mittal-译CherryWang" class="headerlink" title="原作者Anushk Mittal    译CherryWang"></a>原作者Anushk Mittal    译CherryWang</h2><p>最近，睡眠记录的改革变成了一种时尚。用户们比以往更关心自己的睡眠质量，他们不仅仅想要知道自己何时入睡，而且想要通过分析收集到的一段睡眠来揭示睡眠的趋势。在硬件上，特别是手机方面的进展，为这个看上去一直在成长的事物带来了全新的光明。<br>Apple提供了一个很酷的方法，以一种安全的方式来进行用户健康信息的交互，并且将数据安全地保存在内置的Health的应用里。你不仅可以用HealthKit来打造<br>一个健身的app，你还可以用这个框架来访问睡眠的数据。<br>在这个教程中，我将给你一个关于HealthKit框架的快速简介，并且演示如何打造一个睡眠分析的简单app。</p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>HealthKit框架提供了一个名为HealthKit Store的加密框架来存储数据。你可以通过HKHealthStore这个类来访问这个数据库。iPhone和Apple Watch都有他们自己的Health Store。健康的数据在iPhone和Apple Watch上是同步的。然而，Apple Watch上定期的删除旧的数据来节省空间。此外，HealthKit和Health app在iPad上不可用。</p>
<p>如果你想打造一个建立在健康数据上的iOS或者watchOS的应用，HealthKit会是一个强大的工具。HealthKit是专业被设计用于管理广泛来源的数据，并且根据用户偏好自动合并不同来源的数据。应用也可以访问各个来源的原始数据，并且将它们合并。数据不仅仅可以被用于对人体测量、健身或营养，也可以被用于睡眠分析。</p>
<p>对于本文的其余部分，我将给你展示如何使用HealthKit框架来在iOS上保存和访问睡眠分析数据。同时，这样的方法也适用于watchOS应用。请注意这个教程适用于Swift2.0和Xcode7。所以，学习本教程时请保证你的Xcode版本高于Xcode7。<br>在开始之前，下载<a href="http://www.appcoda.com/sleep-analysis-healthkit/" target="_blank" rel="external">起始项目</a>  并解压缩，我已经为你创建好具有基本功能的用户界面。当你运行这个起始项目的时候，你会看见一个显示计时器的UI；当你按下启动按钮的时候，你会看到计时器中时间在跑动。</p>
<h3 id="使用HealthKit-框架"><a href="#使用HealthKit-框架" class="headerlink" title="使用HealthKit 框架"></a>使用HealthKit 框架</h3><p>我们这个应用的目的是保存睡眠分析信息和使用start和stop的按钮来检索数据。你必须在你的app的bundle的包里面授予HealthKit这个Capabilities。在app的project中，打开current target -&gt; capabilities  并打开HealthKit。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/HealthKit-allow-1024x640.png" alt="projectpng"></p>
<p>接下来，你需要使用以下代码在ViewController类中创建一个HKHealthStore的实例：<br>    <code>let healthStore = HKHealthStore()</code></p>
<p>接下来我们将使用HKHealthStore实例来访问HealthKit store。<br>正如前面提到的，HealthKit授予用户对自己健康数据的控制权。所以在你获得用户睡眠质量分析的访问（写／读）权之前，你必须首先请求用户的许可。为此，你首先得导入内置的HealthKit框架并这样更新viewDidLoad方法：<br>      <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">override func viewDidload()&#123;</span><br><span class="line">    super.viewDidLoad()</span><br><span class="line">    let typestoRead = Set([</span><br><span class="line">        HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)!</span><br><span class="line">    ])</span><br><span class="line">    let typestoShare = Set([</span><br><span class="line">        HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)!</span><br><span class="line">    ])</span><br><span class="line">    self.healthStore.requestAuthorizationToShareTypes(typetoShare, readTypes: typestoRead )&#123; (success, error) -&gt; Void in</span><br><span class="line">        if success  == false&#123;</span><br><span class="line">             NSLog(&quot; Display not allowed&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这段代码会提示用户允许或拒绝请求的权限。随着block的完成，你可以在回调中处理成功或错误，并获取最终结果。用户可能不同意你的应用请求Health数据的权限，你必须妥善地处理好error。</p>
<p>但是出于测试目的，你必须选择“允许”选项来授予应用访问你的设备上的健康数据的权限。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/Health-App-Permission.png" alt="allowedpng"></p>
<h3 id="写入睡眠分析数据"><a href="#写入睡眠分析数据" class="headerlink" title="写入睡眠分析数据"></a>写入睡眠分析数据</h3><p>首先，我们如何能获取睡眠分析数据？按照Apple的文档，每个睡眠分析样本只能有一个值。为了表示用户在上床了和睡着了的状态，HealthKit使用两个或更多的样本在重叠的时间内记录数据。通过比较这些样本开始和结束的时间，应用可以计算出一些更进一步的数据。</p>
<ol>
<li>用户入睡所花费的时间</li>
<li>用户实际入睡的时间占在床上时间的百分比</li>
<li>用户在床上醒来的次数</li>
<li>在床上与睡着的总时间<br>(第一个图是正确的 第二个图是错误的）<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/Health-App-Permission.png" alt="statisticspng"></li>
</ol>
<p>简单来说，你可以按照下面的方法来将睡眠分析数据保存到Health store:</p>
<ol>
<li>我们需要定义两个NSDate对象分别对应起始和终止时间。</li>
<li>然后我们用HKCategoryTypeIdentifierSleepAnalysis来创建一个HKObjectType实例。</li>
<li>我们需要创建一个HKCategorySample类型的新的对象，通常使用category样本来记录睡眠数据。单个样本代表用户在床上或者睡着的时间段。所以我们会创建一个在床上的样本和一个睡着的样本(两个样本时间重叠)</li>
<li>最后，我们会用HKHealthStore中的saveObject方法来保存对象。<br>｀编者提示：对于样本的类型，你可以在官方文档里查阅相关内容：<a href="https://developer.apple.com/library/ios/documentation/HealthKit/Reference/HealthKit_Constants/index.html#//apple_ref/doc/uid/TP40014710" target="_blank" rel="external">HealthKit Contants Reference</a>｀<br>如果你想要把上述功能用Swift实现，这里有一些代码片段来保存在床上和睡着的睡眠分析数据数值。请在ViewController中插入这个方法:<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">        func saveSleepAnalysis()&#123;</span><br><span class="line">            //alarmTime 和 endTime 是 NSDate 对象</span><br><span class="line">            if let sleepType = HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis) &#123;</span><br><span class="line">               //我们创建了我们想要上传到Health应用中的新对象</span><br><span class="line">                let object = HKCategorySample(type:sleepType, value:HKCategoryValueSleepAnalysis.InBed.rawValue, startDate: self.alarmTime, endDate: self.endTime)</span><br><span class="line"></span><br><span class="line">               //最后我们保存它</span><br><span class="line">                healthStore.saveObject(object, withCompletion: &#123; (success, error) -&gt; Void in</span><br><span class="line"></span><br><span class="line">                if error != nil&#123;</span><br><span class="line">                    //处理错误的代码</span><br><span class="line">                return                </span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if success &#123;</span><br><span class="line">                    print(&quot;My  new data was saved in HealthKit&quot;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    //处理失败的代码</span><br><span class="line">                &#125;</span><br><span class="line">         &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                let object2 = HKCategorySample(type:sleepType, value:HKCategoryValueSleepAnalysis.InBed.rawValue, startDate: self.alarmTime, endDate: self.endTime)</span><br><span class="line">                healthStore.saveObject(object2, withCompletion: &#123; (success, error) -&gt; Void in</span><br><span class="line"></span><br><span class="line">                if error != nil&#123;</span><br><span class="line">                    //处理错误的代码</span><br><span class="line">                return                </span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if success &#123;</span><br><span class="line">                    print(&quot;My  new data (2) was saved in HealthKit&quot;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    //处理失败的代码</span><br><span class="line">                &#125;</span><br><span class="line">         &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<p>这个方法可以在我们想要把睡眠分析数据保存到HealthKit上的时候调用</p>
<h3 id="读取睡眠分析数据"><a href="#读取睡眠分析数据" class="headerlink" title="读取睡眠分析数据"></a>读取睡眠分析数据</h3><p>为了读取睡眠分析数据，我们需要创建一个查询query。首先你应该通过定义一个HKObjectType的category来改变HKCategoryTypeIdentifierSleepAnalysis。你可能还需要用startDate和endDate，这两个分别对应你想要要获取数据的时间范围的NSDate对象来筛选获取的数据。为了获取期望的结果，你还需要创建一个sortDescriptor对获得的查询进行排序。<br>你获取睡眠质量分析的代码应该是这样的：<br>         <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">func retrieveSleepAnalysis()&#123;</span><br><span class="line">        //首先我们定义想要的对象类型</span><br><span class="line">        if let sleepType = HKObjectTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)&#123;</span><br><span class="line">            //用sortDescriptor先获取最近的数据</span><br><span class="line">          let sortDescriptor = NSSortDescriptor(key: HKSampleSortIdentifierEndDate,assending:false)</span><br><span class="line">            //用block来实现我们对查询的创建</span><br><span class="line">          let query = HKSampleQuery(sampleType: sleepType, predicate:nil, limit: 30, sortDescriptors: [sortDescriptor])&#123; (query, tmpResult, error) -&gt; Void in</span><br><span class="line">                if error  != nil&#123;</span><br><span class="line">                //处理错误的代码</span><br><span class="line">                    return</span><br><span class="line">                &#125;</span><br><span class="line">                if let result = tmpresult&#123;</span><br><span class="line">                    for item in result&#123;</span><br><span class="line">                        if let sample = item as?HKCategoryValueSleepAnalysis.InBed.rawValue) ?&quot;InBed&quot; : &quot;Asleep&quot;</span><br><span class="line">                        print(&quot;Healthkit sleep\(sample.startDate)\(sample.endDate) - value:\(value)&quot;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        //最后，我们实现查询</span><br><span class="line">        healthStore.excuteQuery(query)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这段代码查询了HealthKit，获取了所有睡眠分析数据并且以降序形式排列。然后每一个查询用startDate和endDate来打印固定数值(比如在床上或者睡着)。我设置了上限30来获取最近的30条记录样本。你可以使用谓词方法来自定义你的开始和结束日期。</p>
<h3 id="应用测试"><a href="#应用测试" class="headerlink" title="应用测试"></a>应用测试</h3><p>对于demo的程序，当你按下开始按钮，我用NSTimer来展现时间流逝。这些保存睡眠分析数据经过的时间的NSDate对象在开始和结束的按钮按下时被创建。在stop的action方法中，你可以调用saveSleepAnalysis()和retrieveSleepAnaysis()方法来保存或者获取睡眠数据。<br>    ​    ​    ​<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    ​    ​    ​@IBAction func stop(sender: AnyObject)&#123;</span><br><span class="line">    ​    ​    ​endTime = NSDate()</span><br><span class="line">    ​    ​    ​saveSleepAnalysis()</span><br><span class="line">    ​    ​    ​retrieveSleepAnalysis()</span><br><span class="line">    ​    ​    ​timer.invalidate()</span><br><span class="line">    ​    ​    ​&#125;</span><br><span class="line">​    ​    ​    ​</span><br></pre></td></tr></table></figure></p>
<p>在你的app中，你可以改变NSDate对象来选择相应的开始和结束的时间(很有可能是不同的)来保存在床上或者睡着的数值。<br> 一旦你完成了这些代码，你可以运行demo并且开始计时器。让它运行一会然后点击结束按钮。在此之后，打开Health app。你会在那里看到睡眠数据。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/sleep-analysis-test-1024x725-1.png" alt="png1"></p>
<h3 id="对于HealthKit应用的一些建议"><a href="#对于HealthKit应用的一些建议" class="headerlink" title="对于HealthKit应用的一些建议"></a>对于HealthKit应用的一些建议</h3><p>​HealthKit是被设计用来给app开发者提供一个更容易的分享和访问用户数据的平台，并且避免任何可能的重复或矛盾的数据。Apple对使用HealthKit的app有特别的审查条例，如果你请求HealthKit数据的读写权限，但没有明确声明数据的用途，你会在上架请求中被拒绝。<br>​如果App保存了虚假或错误的数据到Health应用中也会被拒绝。这就说明，你计算不同健康数值(像本教程中所讲的睡眠数据)的算法不能太弱智。你应该尝试使用内置的传感器数据来读取和修改任何参数来避免计算出错误的数据。<br>​想要获得完整的demo，你可以点击<a href="https://github.com/appcoda/SleepAnalysis" target="_blank" rel="external">这里</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HealthKit/">-HealthKit</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/iOS/">iOS</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-第三方库Massory和SDAutlayout使用说明" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/25/第三方库Massory和SDAutlayout使用说明/" class="article-date">
  	<time datetime="2016-06-25T02:33:33.000Z" itemprop="datePublished">2016-06-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/25/第三方库Massory和SDAutlayout使用说明/">第三方库Massory和SDAutlayout使用说明</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###All By CherryWang 转载请注明出处</p>
<h1 id="Masonry"><a href="#Masonry" class="headerlink" title="Masonry"></a>Masonry</h1><p>最近做到仿微信朋友圈的动态显示 用到了很多关于屏幕适配的AutoLayout相关的东西 研读了一下Masonry觉得比系统本身的NSLayoutConstraint好用多了<br>不过这个原版的说明是英文版的 使用的时候还是有诸多不便的 我现在写一份使用说明 希望不仅仅能给自己 还能给大家带来一些方便</p>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>首先当然是上github上面的地址<br><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="external">Masonry</a><br>不过如果你是swift开发者的话 这里也有适合你的库<br><a href="https://github.com/SnapKit/SnapKit" target="_blank" rel="external">SnapKit</a></p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>Masonry是一个轻量级的布局框架,使用优雅一点的语言包装了系统自带的NSLayoutConstraint，最重要的一点，它让第三方库更加可读。<br>导入Masonry很简单，用pod就好<br><code>pod &#39;Masonry&#39;</code><br>如果你不想要<code>mas_</code>前缀，在你的全局头文件中加入<br><code>#define MAS_SHORTHAND</code></p>
<p>#开车啦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);</span><br><span class="line"></span><br><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.equalTo(superview.mas_top).with.offset(padding.top); //with is an optional semantic filler</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding.left);</span><br><span class="line">    make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding.right);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/第三方库学习使用/">第三方库学习使用</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/iOS/">iOS</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 BadCodeLu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>

    <script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','EzNcE44GNzWJujjebRZY','2.0.0');
</script>
  </div>
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>