<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>BadCodeLu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="BadCodeLu">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="BadCodeLu">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BadCodeLu">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="BadCodeLu" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xs3ih.com1.z0.glb.clouddn.com/WechatIMG5.jpeg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">BadCodeLu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">漫漫长夜，写代码时候有你相伴</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>About</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/随笔">随笔</a></li>
				        
							<li><a href="/photo">相册</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/hehedalulu" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/1043667310/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/wang-lu-lu-51-41" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/HealthKit/" style="font-size: 20px;">-HealthKit</a> <a href="/tags/Objective-C/" style="font-size: 10px;">-Objective-C</a> <a href="/tags/hexo/" style="font-size: 20px;">-hexo</a> <a href="/tags/iOS小细节/" style="font-size: 10px;">-iOS小细节</a> <a href="/tags/iOS页面优化相关/" style="font-size: 10px;">-iOS页面优化相关</a> <a href="/tags/java/" style="font-size: 10px;">-java</a> <a href="/tags/mac软件/" style="font-size: 20px;">-mac软件</a> <a href="/tags/plan/" style="font-size: 10px;">-plan</a> <a href="/tags/storyboard/" style="font-size: 10px;">-storyboard</a> <a href="/tags/梦想/" style="font-size: 10px;">-梦想</a> <a href="/tags/生活杂记/" style="font-size: 20px;">-生活杂记</a> <a href="/tags/第三方库学习使用/" style="font-size: 10px;">-第三方库学习使用</a> <a href="/tags/CoreMotion/" style="font-size: 10px;">CoreMotion</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a> <a href="/tags/iOS内存管理/" style="font-size: 10px;">iOS内存管理</a> <a href="/tags/iOS学习/" style="font-size: 10px;">iOS学习</a> <a href="/tags/iOS系统的SDK/" style="font-size: 10px;">iOS系统的SDK</a> <a href="/tags/plan/" style="font-size: 10px;">plan</a> <a href="/tags/storyboard/" style="font-size: 10px;">storyboard</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/第三方库学习使用/" style="font-size: 10px;">第三方库学习使用</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">BadCodeLu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xs3ih.com1.z0.glb.clouddn.com/WechatIMG5.jpeg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">BadCodeLu</h1>
			</hgroup>
			
			<p class="header-subtitle">漫漫长夜，写代码时候有你相伴</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
					<li><a href="/photo">相册</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/hehedalulu" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/1043667310/profile?rightmod=1&wvr=6&mod=personinfo" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/wang-lu-lu-51-41" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-iOS中各种传感器使用的介绍与教程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/26/iOS中各种传感器使用的介绍与教程/" class="article-date">
  	<time datetime="2016-10-26T04:43:42.000Z" itemprop="datePublished">2016-10-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/26/iOS中各种传感器使用的介绍与教程/">iOS中各种传感器使用的介绍与教程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="all-by-BadCodeLu-转载请注明出处"><a href="#all-by-BadCodeLu-转载请注明出处" class="headerlink" title="all by BadCodeLu 转载请注明出处"></a>all by BadCodeLu 转载请注明出处</h3><p>最近有做到调用系统底层的一些SDK，在iOS10中，我们已知的传感器有<br>环境光传感器 （调节屏幕的亮度）<br>距离传感器(打电话自动黑屏)<br>磁力计传感器（感应周边的磁场）<br>内部温度传感器（提醒用户降温 防止损伤设备）<br>湿度传感器<br>（上面的都是不常用的 也就是说并没有什么卵用的 下面的比较有用<br>陀螺仪（感应设备的的平衡 或者说是持握方式）（赛车类游戏 重力弹球）<br>加速器 (感受设备的运动 摇一摇 记步器)</p>
<p>介绍几个吧</p>
<h3 id="1-距离传感器"><a href="#1-距离传感器" class="headerlink" title="1.距离传感器"></a>1.距离传感器</h3><p>距离传感器是通过添加观察者 监听通知来实现的<br>通知的名称是 UIDeviceProximityStateDidChangeNotification<br>监听的状态是 [UIDevice currentDevice].proximityState<br>使用的代码是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad</span><br><span class="line">&#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // [UIApplication sharedApplication].proximitySensingEnabled = YES;</span><br><span class="line">    [UIDevice currentDevice].proximityMonitoringEnabled = YES;</span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(proximityStateDidChange) name:UIDeviceProximityStateDidChangeNotification object:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)proximityStateDidChange</span><br><span class="line">&#123;</span><br><span class="line">    if ([UIDevice currentDevice].proximityState) &#123;</span><br><span class="line">        NSLog(@&quot;手机靠近&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        NSLog(@&quot;手机离开&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="加速度传感器和陀螺仪"><a href="#加速度传感器和陀螺仪" class="headerlink" title="加速度传感器和陀螺仪"></a>加速度传感器和陀螺仪</h4><p>要做加速度传感器和陀螺仪相关<br>我们需要了解CoreMotion.Framework这个框架<br>这个框架不仅仅提供给你获得实时的加速度值和旋转速度值，更重要的是，苹果在其中集成了很多算法，可以直接给你输出把重力加速度分量剥离的加速度，省去你的高通滤波操作，以及提供给你一个专门的设备的三维位置信息。<br>CoreMotion框架的使用</p>
<h2 id="基本数据"><a href="#基本数据" class="headerlink" title="基本数据"></a>基本数据</h2><p>加速度值      CMAccelerometerData<br>陀螺仪值      CMGyroData<br>设备motion值  CMDeviceMotion<br>  设备的motion值是通过加速度和旋转速度进行变换算出来的<br>  CMDeviceMotion的属性<br>      attitude：手机在当前空间的位置和姿势<br>      gravity：重力信息，重力加速度矢量在当前设备的参考坐标系中的表达<br>      userAcceleration：加速度信息<br>      rotationRate：即时的旋转速率，是陀螺仪的输出</p>
<h2 id="使用的步骤"><a href="#使用的步骤" class="headerlink" title="使用的步骤"></a>使用的步骤</h2><ol>
<li>初始化CMMotionManager管理对象</li>
<li>调用管理对象的对象方法获取数据，有2种方式</li>
<li>处理数据</li>
<li>当你不需要使用的时候，停止获取数据<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(void)stopAccelerometerUpdates;//停止获取加速度计数据</span><br><span class="line">-(void)stopGyroUpdates;//停止获取陀螺仪数据</span><br><span class="line">-(void)stopDeviceMotionUpdates;//停止获取设备motion数据</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="获取数据的两种方式"><a href="#获取数据的两种方式" class="headerlink" title="获取数据的两种方式"></a>获取数据的两种方式</h2><p>Push方式：<br>提供一个线程管理器NSOperationQueue和一个回调Block，CoreMotion自动在每一个采样数据到来的时候回调这个Block，进行处理。在这种情况下，Block中的操作会在你自己的主线程内执行。<br>Pull方式：<br>你必须主动去向CMMotionManager要数据，这个数据就是最近一次的采样数据。你不去要，CMMotionManager就不会给你。</p>
<h3 id="2-加速度传感器"><a href="#2-加速度传感器" class="headerlink" title="2.加速度传感器"></a>2.加速度传感器</h3><p>加速器传感器的读取其实还是蛮酷的 监听的方式是通过设置代理实现的 它能够监测设备在xyz轴上不同的加速度情况<br>具体的实现逻辑是</p>
<ol>
<li>获取加速器的单例对象<br><code>UIAccelerometer *accelerometer = [UIAccelerometer sharedAccelerometer];</code></li>
<li>获取加速器的代理对象<br><code>accelerometer.delegate = self;</code></li>
<li>设置采样间隔<br><code>accelerometer.updateInterval = 0.3;</code></li>
<li>实现代理相关的方法 监听数据(分为pull和push两种不同的方法)<br><code>- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration;</code></li>
</ol>
<p>使用起来的代码是这样的</p>
<ol>
<li><p>加速度使用pull方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">- (void)useAccelerometerPull&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.motionManager = manager;</span><br><span class="line">    //判断加速度计可不可用，判断加速度计是否开启</span><br><span class="line">    if ([manager isAccelerometerAvailable] &amp;&amp; [manager isAccelerometerActive])&#123;</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.accelerometerUpdateInterval = 0.01;</span><br><span class="line">        //开始更新，后台线程开始运行。这是Pull方式。</span><br><span class="line">        [manager startAccelerometerUpdates];</span><br><span class="line">    &#125;</span><br><span class="line">    //获取并处理加速度计数据</span><br><span class="line">    CMAccelerometerData *newestAccel = self.motionManager.accelerometerData;</span><br><span class="line">    NSLog(@&quot;X = %.04f&quot;,newestAccel.acceleration.x);</span><br><span class="line">    NSLog(@&quot;Y = %.04f&quot;,newestAccel.acceleration.y);</span><br><span class="line">    NSLog(@&quot;Z = %.04f&quot;,newestAccel.acceleration.z);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>加速度使用push方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (void)useAccelerometerPush&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.motionManager = manager;</span><br><span class="line">    //判断加速度计可不可用，判断加速度计是否开启</span><br><span class="line">    if ([manager isAccelerometerAvailable] &amp;&amp; [manager isAccelerometerActive])&#123;</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.accelerometerUpdateInterval = 0.01;</span><br><span class="line">        NSOperationQueue *queue = [[NSOperationQueue alloc] init];</span><br><span class="line">        //Push方式获取和处理数据</span><br><span class="line">        [manager startAccelerometerUpdatesToQueue:queue</span><br><span class="line">                 withHandler:^(CMAccelerometerData *accelerometerData, NSError *error)</span><br><span class="line">         &#123;</span><br><span class="line">             NSLog(@&quot;X = %.04f&quot;,accelerometerData.acceleration.x);</span><br><span class="line">             NSLog(@&quot;Y = %.04f&quot;,accelerometerData.acceleration.y);</span><br><span class="line">             NSLog(@&quot;Z = %.04f&quot;,accelerometerData.acceleration.z);</span><br><span class="line">         &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="2-陀螺仪传感器"><a href="#2-陀螺仪传感器" class="headerlink" title="2.陀螺仪传感器"></a>2.陀螺仪传感器</h3><p>陀螺仪传感器使用起来与加速度传感器使用起来是相似的<br>具体代码实现如下</p>
<ol>
<li><p>陀螺仪实现用pull方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//pull的方法实现陀螺仪</span><br><span class="line">- (void)useGyroPull&#123;</span><br><span class="line"></span><br><span class="line">    // 1.判断加速计是否可用</span><br><span class="line">    if (!self.Gyromanager.isAccelerometerAvailable) &#123;</span><br><span class="line">        NSLog(@&quot;加速计不可用，请跟换手机&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 2.开始采集数据</span><br><span class="line">    [self.Gyromanager startAccelerometerUpdates];</span><br><span class="line"></span><br><span class="line">    CMRotationRate rotationRate = self.Gyromanager.gyroData.rotationRate;</span><br><span class="line">    NSLog(@&quot;x:%f-y:%f-z:%f&quot;,rotationRate.x, rotationRate.y, rotationRate.z);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>陀螺仪的实现用push方法获取的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- (void)useGyroPush&#123;</span><br><span class="line">    //初始化全局管理对象</span><br><span class="line">    CMMotionManager *manager = [[CMMotionManager alloc] init];</span><br><span class="line">    self.Gyromanager = manager;</span><br><span class="line">    //判断陀螺仪可不可以，判断陀螺仪是不是开启</span><br><span class="line">    if ([manager isGyroAvailable] &amp;&amp; [manager isGyroActive])&#123;</span><br><span class="line"></span><br><span class="line">        NSOperationQueue *queue = [[NSOperationQueue alloc] init];</span><br><span class="line">        //告诉manager，更新频率是100Hz</span><br><span class="line">        manager.gyroUpdateInterval = 0.01;</span><br><span class="line">        //Push方式获取和处理数据</span><br><span class="line">        [manager startGyroUpdatesToQueue:queue</span><br><span class="line">                             withHandler:^(CMGyroData *gyroData, NSError *error)</span><br><span class="line">         &#123;</span><br><span class="line">             NSLog(@&quot;Gyro Rotation x = %.04f&quot;, gyroData.rotationRate.x);</span><br><span class="line">             NSLog(@&quot;Gyro Rotation y = %.04f&quot;, gyroData.rotationRate.y);</span><br><span class="line">             NSLog(@&quot;Gyro Rotation z = %.04f&quot;, gyroData.rotationRate.z);</span><br><span class="line">         &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><p>push的使用就是利用一个block 不断的回调获取的值 通过isAccelerometerAvailable这个属性来判断能否获取值 但是在官方文档中 isAccelerometerAvailable这个方法只有getter的方法 是没有setter的方法的 所以如果我们想要自己停止获取传感器的值 就要另加一个bool类型的参数自己传进去 当然也可以利用多线程进行时间的的限制 repeats设置成1次就好了 但是还是有这样那样的问题 如果大家有什么好的可以控制传感器进程的方法请给我评论哦 我会认真的看的</p>
<h5 id="以上的demo已上传到github上面-BadCodeLu的github的demo链接"><a href="#以上的demo已上传到github上面-BadCodeLu的github的demo链接" class="headerlink" title="以上的demo已上传到github上面 BadCodeLu的github的demo链接"></a>以上的demo已上传到github上面 <a href="https://github.com/hehedalulu/SensorIniOS/tree/master" target="_blank" rel="external">BadCodeLu的github的demo链接</a></h5>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoreMotion/">CoreMotion</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS系统的SDK/">iOS系统的SDK</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-HealthKit的数据读取" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/21/HealthKit的数据读取/" class="article-date">
  	<time datetime="2016-10-21T09:27:30.000Z" itemprop="datePublished">2016-10-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/21/HealthKit的数据读取/">HealthKit的数据读取</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="最近pm突发奇想-因为iOS读取HealthKit的数据会很方便-所以想要用HealthKit的数据做一读取步数-存储步数-向支付宝的蚂蚁森林一样增加EXP-此处好想黑安卓一把哈哈哈-言归正传-上次翻译了一篇Swift版本的-决定自己撸一遍Objective-C版本的-留着方便以后再次使用。"><a href="#最近pm突发奇想-因为iOS读取HealthKit的数据会很方便-所以想要用HealthKit的数据做一读取步数-存储步数-向支付宝的蚂蚁森林一样增加EXP-此处好想黑安卓一把哈哈哈-言归正传-上次翻译了一篇Swift版本的-决定自己撸一遍Objective-C版本的-留着方便以后再次使用。" class="headerlink" title="最近pm突发奇想 因为iOS读取HealthKit的数据会很方便 所以想要用HealthKit的数据做一读取步数 存储步数 向支付宝的蚂蚁森林一样增加EXP 此处好想黑安卓一把哈哈哈 言归正传 上次翻译了一篇Swift版本的 决定自己撸一遍Objective-C版本的 留着方便以后再次使用。"></a>最近pm突发奇想 因为iOS读取HealthKit的数据会很方便 所以想要用HealthKit的数据做一读取步数 存储步数 向支付宝的蚂蚁森林一样增加EXP 此处好想黑安卓一把哈哈哈 言归正传 上次翻译了一篇Swift版本的 决定自己撸一遍Objective-C版本的 留着方便以后再次使用。</h2><p>在iOS中 统计步数信息不许用我们通过自己去实现 iOS自带的健康app就已经提供好了数据 就像我之前翻译的那篇文章一样 HealthKit里面所有的数据都存储在HealthStore里面<br>想要深入的话 大家可以阅读<healthkit healthkit.h="">这个框架<br>我这里实在ViewController里面实现的 我看了一下其他人的介绍 其实好像更加建议吧数据权限的读取放在AppDelegate里面</healthkit></p>
<h4 id="First-Step-在project文件的Capabilities里打开HealthKit的选项"><a href="#First-Step-在project文件的Capabilities里打开HealthKit的选项" class="headerlink" title="First Step 在project文件的Capabilities里打开HealthKit的选项"></a>First Step 在project文件的Capabilities里打开HealthKit的选项</h4><p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-10-21%20%E4%B8%8B%E5%8D%888.34.45.png" alt=""></p>
<h4 id="Second-Step-创建一个HKHealthStore的实例来访问HealthKit-Store"><a href="#Second-Step-创建一个HKHealthStore的实例来访问HealthKit-Store" class="headerlink" title="Second Step 创建一个HKHealthStore的实例来访问HealthKit Store"></a>Second Step 创建一个HKHealthStore的实例来访问HealthKit Store</h4><pre><code>在.h文件中添加
` @property(nonatomic,strong) HKHealthStore *HealthStore`

在访问HealthStore里面的数据之前 你必须要首先请求用户的许可 所以你必须要添加这样一段代码
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    //先判断设备支不支持HealthKit</span><br><span class="line">    if(![HKHealthStore isHealthDataAvailable])&#123;</span><br><span class="line">      NSLog&quot;不支持HealthKit&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    //创建HealthStore对象</span><br><span class="line">    self.healthStore = [[HKHealthStore alloc]init];</span><br><span class="line">    //设置需要获取的权限 如果想用其他数据可以写别的type</span><br><span class="line">    HKObjectType *stepType = [HKObjectType quantityTypeForIdentifier:HKQuantityTypeIdentifierStepCount];  </span><br><span class="line">    NSSet *healthSet = [NSSet setWithObjects:stepType,nil];</span><br><span class="line">    //用一个block来实现权限的获取</span><br><span class="line">    [self.healthStore requestAuthorizationToShareTypes:nil readTypes:healthSet completion:^(BOOL success, NSError * _Nullable error) &#123;  </span><br><span class="line">    if (success) &#123;  </span><br><span class="line">        [self ReadStep];  </span><br><span class="line">    &#125;  </span><br><span class="line">    else  </span><br><span class="line">    &#123;  </span><br><span class="line">        NSLog@&quot;获取步数权限失败&quot;;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
</code></pre><h3 id="Third-Step-用HKSample采用读取步数"><a href="#Third-Step-用HKSample采用读取步数" class="headerlink" title="Third Step 用HKSample采用读取步数"></a>Third Step 用HKSample采用读取步数</h3><p>   在ReadStep中读取步数<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">  -(void)ReadStep&#123;</span><br><span class="line">  HKSampleType ＊sampleType = [HKQuantityType quantityTypeForIdentifier: HKQuantityTypeIdentifierStepCount];</span><br><span class="line">  //将healthStore的结果排序</span><br><span class="line">  NSSortDescriptor *start = [NSSortDescriptor sortDescriptionWithKey:HKSampleSortIdentifierStartDate ascending:NO];</span><br><span class="line">  NSSortDescriptor *end = [NSSortDescriptor sortDescriptorWithKey:HKSampleSortIdentifierEndDate ascending:NO];</span><br><span class="line">  //获取事件</span><br><span class="line">  NSDate *now = [NSDate date];  </span><br><span class="line">  NSCalendar *calender = [NSCalendar currentCalendar];  </span><br><span class="line">  NSUInteger unitFlags = NSCalendarUnitYear | NSCalendarUnitMonth | NSCalendarUnitDay | NSCalendarUnitHour | NSCalendarUnitMinute | NSCalendarUnitSecond;  </span><br><span class="line">  NSDateComponents *dateComponent = [calender components:unitFlags fromDate:now];  </span><br><span class="line">  int hour = (int)[dateComponent hour];       int minute = (int)[dateComponent minute];  </span><br><span class="line">  int second = (int)[dateComponent second];  </span><br><span class="line">  NSDate *nowDay = [NSDate dateWithTimeIntervalSinceNow:  - (hour*3600 + minute * 60 + second) ];  </span><br><span class="line">  //时间结果与想象中不同是因为它显示的是0区  </span><br><span class="line">  NSLog(@&quot;今天%@&quot;,nowDay);  </span><br><span class="line">  NSDate *nextDay = [NSDate dateWithTimeIntervalSinceNow:  - (hour*3600 + minute * 60 + second)  + 86400];  </span><br><span class="line">  NSLog(@&quot;明天%@&quot;,nextDay);  </span><br><span class="line">  NSPredicate *predicate = [HKQuery predicateForSamplesWithStartDate:nowDay endDate:nextDay options:(HKQueryOptionNone)];</span><br><span class="line"></span><br><span class="line">  /*</span><br><span class="line">  查询的基类是HKQuery，这是一个抽象类，能够实现每一种查询目标，这里我们需要查询的步数是一个HKSample类所以对应的查询类是HKSampleQuery。下面的limit参数传1表示查询最近一条数据，查询多条数据只要设置limit的参数值就可以了</span><br><span class="line">  */  </span><br><span class="line">  HKSampleQuery *sampleQuery = [[HKSampleQuery alloc]initWithSampleType:sampleType predicate:predicate limit:0 sortDescriptors:@[start,end] resultsHandler:^(HKSampleQuery * _Nonnull query, NSArray&lt;__kindof HKSample *&gt; * _Nullable results, NSError * _Nullable error) &#123;  </span><br><span class="line">    //设置一个int型变量来作为步数统计  </span><br><span class="line">    int allStepCount = 0;  </span><br><span class="line">    for (int i = 0; i &lt; results.count; i ++) &#123;  </span><br><span class="line">        //把结果转换为字符串类型  </span><br><span class="line">        HKQuantitySample *result = results[i];  </span><br><span class="line">        HKQuantity *quantity = result.quantity;  </span><br><span class="line">        NSMutableString *stepCount = (NSMutableString *)quantity;  </span><br><span class="line">        NSString *stepStr =[ NSString stringWithFormat:@&quot;%@&quot;,stepCount];  </span><br><span class="line">        //获取51 count此类字符串前面的数字  </span><br><span class="line">        NSString *str = [stepStr componentsSeparatedByString:@&quot; &quot;][0];  </span><br><span class="line">        int stepNum = [str intValue];  </span><br><span class="line">        NSLog(@&quot;%d&quot;,stepNum);  </span><br><span class="line">        //把一天中所有时间段中的步数加到一起  </span><br><span class="line">        allStepCount = allStepCount + stepNum;  </span><br><span class="line">    &#125;  </span><br><span class="line">    //查询要放在多线程中进行，如果要对UI进行刷新，要回到主线程  </span><br><span class="line">&#125;];  </span><br><span class="line">//执行查询  </span><br><span class="line">[self.healthStore executeQuery:sampleQuery];  </span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HealthKit/">-HealthKit</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-（转）shadowsocks使用教程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/08/24/（转）shadowsocks使用教程/" class="article-date">
  	<time datetime="2016-08-24T09:38:31.000Z" itemprop="datePublished">2016-08-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/24/（转）shadowsocks使用教程/">（转）shadowsocks图文使用教程 </a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>此文为转载，因原网站被墙，广大亲朋好友为翻墙求助于我，秉着服务大众的心，希望可以给他人一些帮助</p>
<h5 id="Shadowsocks科学上网图文教程"><a href="#Shadowsocks科学上网图文教程" class="headerlink" title="Shadowsocks科学上网图文教程"></a>Shadowsocks科学上网图文教程</h5><p>SS的全称是Shadowsocks，是一种轻量级的加密的socks5网络代理，经本人测试速度比VPN快很多，观看YouTube视频非常流畅，是迄今为止最快的科学工具。下面分别介绍在Windows, Mac OS X, Linux, iOS, Android等系统下怎样使用Shadowsocks科学上网。</p>
<h3 id="1-获取SS账号"><a href="#1-获取SS账号" class="headerlink" title="1.获取SS账号"></a>1.获取SS账号</h3><p>首先要有一个Shadowsocks账号（SS账号）。没有SS账号？新浪微博关注 @SS账号 。或者到 <a href="https://www.ss-link.me/" target="_blank" rel="external">www.ss-link.me</a>  获取免费的试用SS账号。</p>
<p>另外，在开始配置之前和配置之后，可以用ip111.cn这样验证一下能否科学上网，用什么方式科学上网的。</p>
<h3 id="2-Windows系统"><a href="#2-Windows系统" class="headerlink" title="2. Windows系统"></a>2. Windows系统</h3><p>到  <a href="https://blog.ss-link.com/dl/Windows/" target="_blank" rel="external">https://blog.ss-link.com/dl/Windows/</a>  下载SS客户端软件，任何一个即可。下载完成后解压缩，建议把可执行文件拷贝到一个固定的目录下，比如D:\SS\ 。</p>
<p>双击运行程序，在Windows右下角的图标区域就会多一个像纸飞机一样的图标，这个就是客户端程序，如下图：<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/ss-icon.png" alt="ss-icon"></p>
<p>鼠标右键点击这个纸飞机图标，会出现客户端的主菜单，如下图：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/win-ss.png" alt="win-ss"></p>
<p>把SS账号的二维码图片显示在电脑上，在Windows的SS客户端上（注意：不是手机）点击“服务器选择”，“扫描屏幕上的二维码”， 客户端软件会识别屏幕上的二维码自动配置（电脑不需要有摄像头）</p>
<p>然后点击“确定”回到主菜单，选择“启用代理”和“开机启动”，让这两项前面都有对号，也就是选择上，这样客户端就配置好了。</p>
<p>在主菜单里面，点击代理模式，可以选择PAC模式或者全局模式，前者的意思是只有访问被墙的网站才通过SS账号访问，国内网站和国外没有被墙的网站不通过SS账号。全局模式则是所有访问都走SS。</p>
<p>推荐使用Firefox浏览器，打开选项，高级，网络，设置，如下图配置。注意四个红圈。</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/firefox-ss2.png" alt="firefox-ss"></p>
<p>现在就可以科学上网了，访问 <a href="http://ip111.cn" target="_blank" rel="external">http://ip111.cn</a>  验证一下吧。</p>
<ol>
<li>Mac OS 系统</li>
</ol>
<p>到 <a href="https://blog.ss-link.com/dl/MacOS/" target="_blank" rel="external">https://blog.ss-link.com/dl/MacOS/</a> 下载Mac OS的客户端程序ShadowsocksX并安装运行。主界面如下：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/macselect.png" alt="macselect"></p>
<p>把二维码显示在屏幕上，点击“从屏幕上扫描二维码…”，即可识别屏幕上的二维码自动配置。</p>
<p>点击“打开Shadowsocks”开启SS，然后就可以科学上网了，访问<a href="http://ip111.cn" target="_blank" rel="external">http://ip111.cn</a>  测试一下吧。</p>
<ol>
<li>iOS系统(苹果手机)</li>
</ol>
<p>iOS无需越狱，可以安装ShadowRocket或者Surge，任何一个都可以。ShadowRocket价格便宜并且使用方便，主界面如下，点击左上角的方框可以扫描SS账号的二维码，然后点击”Connected”后面的开关即可科学上网。有时Settings下面的Global Routing需要选择Proxy。Settings下面的On Demand要关闭，Auto Close也不启用，否则会出现Shadowrocket无法断开的情况。</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/shadowrocket-169x300.png" alt="shadowrocket"></p>
<ol>
<li>Android系统</li>
</ol>
<p>下载并安装 <a href="https://blog.ss-link.com/dl/Android/" target="_blank" rel="external">https://blog.ss-link.com/dl/Android/</a> 这里的两个软件，一个是Android SS客户端，一个是扫描二维码需要的软件。两个软件都要安装。运行SS客户端，主界面如下：</p>
<p><img src="http://7xs3ih.com1.z0.glb.clouddn.com/android-ss-169x300.jpg" alt="android-ss"></p>
<p>点击左上角的纸飞机标志，然后分别点击“添加配置文件”，“扫描二维码”，出现扫描界面，用手机扫描一下SS账号对应的二维码图片就配置好了。再点击“路由”选择“绕过局域网及中国大陆地址”，最后点击右上角的“关闭/打开”按钮开启和关闭SS。然后就可以科学上网了。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac软件/">-mac软件</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-抑郁与负能量" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/15/抑郁与负能量/" class="article-date">
  	<time datetime="2016-07-15T12:35:26.000Z" itemprop="datePublished">2016-07-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/15/抑郁与负能量/">抑郁与负能量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="抑郁？"><a href="#抑郁？" class="headerlink" title="抑郁？"></a>抑郁？</h2><p>  感觉自己抑郁有一阵子了，非常抵触与熟人之间的沟通。很多时候宁可与陌生人交谈都不愿意与熟人进行眼神沟通。生活压力大，对人生感到迷茫，在孤独的时间游身太久了，自己都忘了自己应该是什么样的人了。<br>  是什么会让一个天生活跃的人变的如此抑郁呢？或许冷漠与黑暗是我原来的属性，但这个浮躁的世界太喜欢活跃的人了，也许我应要变得合群变得外向变得开放。有的时候想想这样的人也真是可笑。为什么自己不能是阴郁的是孤独的呢？人生来孤独，我们来到这个世界上的时候是孤身一人的，怎么会有一个人能比你自己还要更加了解你自己呢？别人不能对你所处之境感同身受，不会明白你在想什么，也不会知道你是什么样的。他们只会用他们那般残缺的带着偏见的眼神去打量你。经历了一段失败的感情之后我明白一个道理，一个人绝对不可能完全感受到另一个人的感受。你痛你受伤在别人眼里只是一件既定的客观事实，他们只能在自己的角度来观察。一个人和另一个人之间是两个不同的小宇宙，或许你们会有交集，相处时间久了之后或许会成为并集，但是绝对不会是相等的。如果强行的进行匹配，进行相等的切割，那么剩下的只会是血与泪，而不是幸福的火花。<br>  我把自己关在实验室已经三个多月了，从一开始的不知所措到后来找到可以安身立命的事业，好像一瞬间变老了很多。游荡的久了，人也渐渐的变质了，感觉自己的思想也变得偏执与不堪。是受到黑暗的侵蚀了么？我不知道。<br>  也许每一个人都会在人生的每一个阶段迷失自己，这段时间可能很长，也可能很短，可能是短短的几天，也可能是漫长的一生。但我们曾经都渴望过要以积极的心态活着不是么？就算这个不公的世界给自己带来了多少失意，但是我们还是渴望获得快乐的活着不是么？也许这个世界对我们展现的是不友好，但我们也不应该分裂的排斥自己不是么？<br>  经常的经常，我还是会想起你。但事与愿违，缘分到这里就结束了。曾经那么多次内心的挣扎，现实却打了你一记耳光。不断的做着无用功，却始终相信这些功可能会以另一种光和热的形式展现。多么可笑。<br>  还是继续努力吧，希望能与一群优秀的人并肩。一个人可以走的很快，可以一群人才可以走的很远。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生活杂记/">-生活杂记</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-在HealthKit中使用Sleep-Analysis" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/08/在HealthKit中使用Sleep-Analysis/" class="article-date">
  	<time datetime="2016-07-08T01:03:08.000Z" itemprop="datePublished">2016-07-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/08/在HealthKit中使用Sleep-Analysis/"> 在HealthKit中使用Sleep Analysis</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="在HealthKit中使用Sleep-Analysis"><a href="#在HealthKit中使用Sleep-Analysis" class="headerlink" title="在HealthKit中使用Sleep Analysis"></a>在HealthKit中使用Sleep Analysis</h1><h2 id="原作者Anushk-Mittal-译CherryWang"><a href="#原作者Anushk-Mittal-译CherryWang" class="headerlink" title="原作者Anushk Mittal    译CherryWang"></a>原作者Anushk Mittal    译CherryWang</h2><p>最近，睡眠记录的改革变成了一种时尚。用户们比以往更关心自己的睡眠质量，他们不仅仅想要知道自己何时入睡，而且想要通过分析收集到的一段睡眠来揭示睡眠的趋势。在硬件上，特别是手机方面的进展，为这个看上去一直在成长的事物带来了全新的光明。<br>Apple提供了一个很酷的方法，以一种安全的方式来进行用户健康信息的交互，并且将数据安全地保存在内置的Health的应用里。你不仅可以用HealthKit来打造<br>一个健身的app，你还可以用这个框架来访问睡眠的数据。<br>在这个教程中，我将给你一个关于HealthKit框架的快速简介，并且演示如何打造一个睡眠分析的简单app。</p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>HealthKit框架提供了一个名为HealthKit Store的加密框架来存储数据。你可以通过HKHealthStore这个类来访问这个数据库。iPhone和Apple Watch都有他们自己的Health Store。健康的数据在iPhone和Apple Watch上是同步的。然而，Apple Watch上定期的删除旧的数据来节省空间。此外，HealthKit和Health app在iPad上不可用。</p>
<p>如果你想打造一个建立在健康数据上的iOS或者watchOS的应用，HealthKit会是一个强大的工具。HealthKit是专业被设计用于管理广泛来源的数据，并且根据用户偏好自动合并不同来源的数据。应用也可以访问各个来源的原始数据，并且将它们合并。数据不仅仅可以被用于对人体测量、健身或营养，也可以被用于睡眠分析。</p>
<p>对于本文的其余部分，我将给你展示如何使用HealthKit框架来在iOS上保存和访问睡眠分析数据。同时，这样的方法也适用于watchOS应用。请注意这个教程适用于Swift2.0和Xcode7。所以，学习本教程时请保证你的Xcode版本高于Xcode7。<br>在开始之前，下载<a href="http://www.appcoda.com/sleep-analysis-healthkit/" target="_blank" rel="external">起始项目</a>  并解压缩，我已经为你创建好具有基本功能的用户界面。当你运行这个起始项目的时候，你会看见一个显示计时器的UI；当你按下启动按钮的时候，你会看到计时器中时间在跑动。</p>
<h3 id="使用HealthKit-框架"><a href="#使用HealthKit-框架" class="headerlink" title="使用HealthKit 框架"></a>使用HealthKit 框架</h3><p>我们这个应用的目的是保存睡眠分析信息和使用start和stop的按钮来检索数据。你必须在你的app的bundle的包里面授予HealthKit这个Capabilities。在app的project中，打开current target -&gt; capabilities  并打开HealthKit。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/HealthKit-allow-1024x640.png" alt="projectpng"></p>
<p>接下来，你需要使用以下代码在ViewController类中创建一个HKHealthStore的实例：<br>    <code>let healthStore = HKHealthStore()</code></p>
<p>接下来我们将使用HKHealthStore实例来访问HealthKit store。<br>正如前面提到的，HealthKit授予用户对自己健康数据的控制权。所以在你获得用户睡眠质量分析的访问（写／读）权之前，你必须首先请求用户的许可。为此，你首先得导入内置的HealthKit框架并这样更新viewDidLoad方法：<br>      <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">override func viewDidload()&#123;</span><br><span class="line">    super.viewDidLoad()</span><br><span class="line">    let typestoRead = Set([</span><br><span class="line">        HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)!</span><br><span class="line">    ])</span><br><span class="line">    let typestoShare = Set([</span><br><span class="line">        HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)!</span><br><span class="line">    ])</span><br><span class="line">    self.healthStore.requestAuthorizationToShareTypes(typetoShare, readTypes: typestoRead )&#123; (success, error) -&gt; Void in</span><br><span class="line">        if success  == false&#123;</span><br><span class="line">             NSLog(&quot; Display not allowed&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这段代码会提示用户允许或拒绝请求的权限。随着block的完成，你可以在回调中处理成功或错误，并获取最终结果。用户可能不同意你的应用请求Health数据的权限，你必须妥善地处理好error。</p>
<p>但是出于测试目的，你必须选择“允许”选项来授予应用访问你的设备上的健康数据的权限。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/Health-App-Permission.png" alt="allowedpng"></p>
<h3 id="写入睡眠分析数据"><a href="#写入睡眠分析数据" class="headerlink" title="写入睡眠分析数据"></a>写入睡眠分析数据</h3><p>首先，我们如何能获取睡眠分析数据？按照Apple的文档，每个睡眠分析样本只能有一个值。为了表示用户在上床了和睡着了的状态，HealthKit使用两个或更多的样本在重叠的时间内记录数据。通过比较这些样本开始和结束的时间，应用可以计算出一些更进一步的数据。</p>
<ol>
<li>用户入睡所花费的时间</li>
<li>用户实际入睡的时间占在床上时间的百分比</li>
<li>用户在床上醒来的次数</li>
<li>在床上与睡着的总时间<br>(第一个图是正确的 第二个图是错误的）<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/Health-App-Permission.png" alt="statisticspng"></li>
</ol>
<p>简单来说，你可以按照下面的方法来将睡眠分析数据保存到Health store:</p>
<ol>
<li>我们需要定义两个NSDate对象分别对应起始和终止时间。</li>
<li>然后我们用HKCategoryTypeIdentifierSleepAnalysis来创建一个HKObjectType实例。</li>
<li>我们需要创建一个HKCategorySample类型的新的对象，通常使用category样本来记录睡眠数据。单个样本代表用户在床上或者睡着的时间段。所以我们会创建一个在床上的样本和一个睡着的样本(两个样本时间重叠)</li>
<li>最后，我们会用HKHealthStore中的saveObject方法来保存对象。<br>｀编者提示：对于样本的类型，你可以在官方文档里查阅相关内容：<a href="https://developer.apple.com/library/ios/documentation/HealthKit/Reference/HealthKit_Constants/index.html#//apple_ref/doc/uid/TP40014710" target="_blank" rel="external">HealthKit Contants Reference</a>｀<br>如果你想要把上述功能用Swift实现，这里有一些代码片段来保存在床上和睡着的睡眠分析数据数值。请在ViewController中插入这个方法:<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">        func saveSleepAnalysis()&#123;</span><br><span class="line">            //alarmTime 和 endTime 是 NSDate 对象</span><br><span class="line">            if let sleepType = HKObjectType.categoryTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis) &#123;</span><br><span class="line">               //我们创建了我们想要上传到Health应用中的新对象</span><br><span class="line">                let object = HKCategorySample(type:sleepType, value:HKCategoryValueSleepAnalysis.InBed.rawValue, startDate: self.alarmTime, endDate: self.endTime)</span><br><span class="line"></span><br><span class="line">               //最后我们保存它</span><br><span class="line">                healthStore.saveObject(object, withCompletion: &#123; (success, error) -&gt; Void in</span><br><span class="line"></span><br><span class="line">                if error != nil&#123;</span><br><span class="line">                    //处理错误的代码</span><br><span class="line">                return                </span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if success &#123;</span><br><span class="line">                    print(&quot;My  new data was saved in HealthKit&quot;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    //处理失败的代码</span><br><span class="line">                &#125;</span><br><span class="line">         &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                let object2 = HKCategorySample(type:sleepType, value:HKCategoryValueSleepAnalysis.InBed.rawValue, startDate: self.alarmTime, endDate: self.endTime)</span><br><span class="line">                healthStore.saveObject(object2, withCompletion: &#123; (success, error) -&gt; Void in</span><br><span class="line"></span><br><span class="line">                if error != nil&#123;</span><br><span class="line">                    //处理错误的代码</span><br><span class="line">                return                </span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if success &#123;</span><br><span class="line">                    print(&quot;My  new data (2) was saved in HealthKit&quot;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    //处理失败的代码</span><br><span class="line">                &#125;</span><br><span class="line">         &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<p>这个方法可以在我们想要把睡眠分析数据保存到HealthKit上的时候调用</p>
<h3 id="读取睡眠分析数据"><a href="#读取睡眠分析数据" class="headerlink" title="读取睡眠分析数据"></a>读取睡眠分析数据</h3><p>为了读取睡眠分析数据，我们需要创建一个查询query。首先你应该通过定义一个HKObjectType的category来改变HKCategoryTypeIdentifierSleepAnalysis。你可能还需要用startDate和endDate，这两个分别对应你想要要获取数据的时间范围的NSDate对象来筛选获取的数据。为了获取期望的结果，你还需要创建一个sortDescriptor对获得的查询进行排序。<br>你获取睡眠质量分析的代码应该是这样的：<br>         <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">func retrieveSleepAnalysis()&#123;</span><br><span class="line">        //首先我们定义想要的对象类型</span><br><span class="line">        if let sleepType = HKObjectTypeForIdentifier(HKCategoryTypeIdentifierSleepAnalysis)&#123;</span><br><span class="line">            //用sortDescriptor先获取最近的数据</span><br><span class="line">          let sortDescriptor = NSSortDescriptor(key: HKSampleSortIdentifierEndDate,assending:false)</span><br><span class="line">            //用block来实现我们对查询的创建</span><br><span class="line">          let query = HKSampleQuery(sampleType: sleepType, predicate:nil, limit: 30, sortDescriptors: [sortDescriptor])&#123; (query, tmpResult, error) -&gt; Void in</span><br><span class="line">                if error  != nil&#123;</span><br><span class="line">                //处理错误的代码</span><br><span class="line">                    return</span><br><span class="line">                &#125;</span><br><span class="line">                if let result = tmpresult&#123;</span><br><span class="line">                    for item in result&#123;</span><br><span class="line">                        if let sample = item as?HKCategoryValueSleepAnalysis.InBed.rawValue) ?&quot;InBed&quot; : &quot;Asleep&quot;</span><br><span class="line">                        print(&quot;Healthkit sleep\(sample.startDate)\(sample.endDate) - value:\(value)&quot;)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        //最后，我们实现查询</span><br><span class="line">        healthStore.excuteQuery(query)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这段代码查询了HealthKit，获取了所有睡眠分析数据并且以降序形式排列。然后每一个查询用startDate和endDate来打印固定数值(比如在床上或者睡着)。我设置了上限30来获取最近的30条记录样本。你可以使用谓词方法来自定义你的开始和结束日期。</p>
<h3 id="应用测试"><a href="#应用测试" class="headerlink" title="应用测试"></a>应用测试</h3><p>对于demo的程序，当你按下开始按钮，我用NSTimer来展现时间流逝。这些保存睡眠分析数据经过的时间的NSDate对象在开始和结束的按钮按下时被创建。在stop的action方法中，你可以调用saveSleepAnalysis()和retrieveSleepAnaysis()方法来保存或者获取睡眠数据。<br>    ​    ​    ​<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    ​    ​    ​@IBAction func stop(sender: AnyObject)&#123;</span><br><span class="line">    ​    ​    ​endTime = NSDate()</span><br><span class="line">    ​    ​    ​saveSleepAnalysis()</span><br><span class="line">    ​    ​    ​retrieveSleepAnalysis()</span><br><span class="line">    ​    ​    ​timer.invalidate()</span><br><span class="line">    ​    ​    ​&#125;</span><br><span class="line">​    ​    ​    ​</span><br></pre></td></tr></table></figure></p>
<p>在你的app中，你可以改变NSDate对象来选择相应的开始和结束的时间(很有可能是不同的)来保存在床上或者睡着的数值。<br> 一旦你完成了这些代码，你可以运行demo并且开始计时器。让它运行一会然后点击结束按钮。在此之后，打开Health app。你会在那里看到睡眠数据。<br><img src="http://7xs3ih.com1.z0.glb.clouddn.com/sleep-analysis-test-1024x725-1.png" alt="png1"></p>
<h3 id="对于HealthKit应用的一些建议"><a href="#对于HealthKit应用的一些建议" class="headerlink" title="对于HealthKit应用的一些建议"></a>对于HealthKit应用的一些建议</h3><p>​HealthKit是被设计用来给app开发者提供一个更容易的分享和访问用户数据的平台，并且避免任何可能的重复或矛盾的数据。Apple对使用HealthKit的app有特别的审查条例，如果你请求HealthKit数据的读写权限，但没有明确声明数据的用途，你会在上架请求中被拒绝。<br>​如果App保存了虚假或错误的数据到Health应用中也会被拒绝。这就说明，你计算不同健康数值(像本教程中所讲的睡眠数据)的算法不能太弱智。你应该尝试使用内置的传感器数据来读取和修改任何参数来避免计算出错误的数据。<br>​想要获得完整的demo，你可以点击<a href="https://github.com/appcoda/SleepAnalysis" target="_blank" rel="external">这里</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HealthKit/">-HealthKit</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-第三方库Massory和SDAutlayout使用说明" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/25/第三方库Massory和SDAutlayout使用说明/" class="article-date">
  	<time datetime="2016-06-25T02:33:33.000Z" itemprop="datePublished">2016-06-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/25/第三方库Massory和SDAutlayout使用说明/">第三方库Massory和SDAutlayout使用说明</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###All By CherryWang 转载请注明出处</p>
<h1 id="Masonry"><a href="#Masonry" class="headerlink" title="Masonry"></a>Masonry</h1><p>最近做到仿微信朋友圈的动态显示 用到了很多关于屏幕适配的AutoLayout相关的东西 研读了一下Masonry觉得比系统本身的NSLayoutConstraint好用多了<br>不过这个原版的说明是英文版的 使用的时候还是有诸多不便的 我现在写一份使用说明 希望不仅仅能给自己 还能给大家带来一些方便</p>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>首先当然是上github上面的地址<br><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="external">Masonry</a><br>不过如果你是swift开发者的话 这里也有适合你的库<br><a href="https://github.com/SnapKit/SnapKit" target="_blank" rel="external">SnapKit</a></p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>Masonry是一个轻量级的布局框架,使用优雅一点的语言包装了系统自带的NSLayoutConstraint，最重要的一点，它让第三方库更加可读。<br>导入Masonry很简单，用pod就好<br><code>pod &#39;Masonry&#39;</code><br>如果你不想要<code>mas_</code>前缀，在你的全局头文件中加入<br><code>#define MAS_SHORTHAND</code></p>
<p>#开车啦<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIEdgeInsets padding = UIEdgeInsetsMake(10, 10, 10, 10);</span><br><span class="line"></span><br><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">    make.top.equalTo(superview.mas_top).with.offset(padding.top); //with is an optional semantic filler</span><br><span class="line">    make.left.equalTo(superview.mas_left).with.offset(padding.left);</span><br><span class="line">    make.bottom.equalTo(superview.mas_bottom).with.offset(-padding.bottom);</span><br><span class="line">    make.right.equalTo(superview.mas_right).with.offset(-padding.right);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/第三方库学习使用/">第三方库学习使用</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-仿网易新闻菜单滑动第三方深度定制" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/20/仿网易新闻菜单滑动第三方深度定制/" class="article-date">
  	<time datetime="2016-06-20T13:27:25.000Z" itemprop="datePublished">2016-06-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/20/仿网易新闻菜单滑动第三方深度定制/">仿网易新闻菜单滑动第三方深度定制</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="仿网易新闻优秀第三方库-（后续上图）"><a href="#仿网易新闻优秀第三方库-（后续上图）" class="headerlink" title="仿网易新闻优秀第三方库 （后续上图）"></a>仿网易新闻优秀第三方库 （后续上图）</h3><h4 id="ALL-BY-CherryWang-转载请注明出处"><a href="#ALL-BY-CherryWang-转载请注明出处" class="headerlink" title="ALL BY CherryWang (转载请注明出处)"></a>ALL BY CherryWang (转载请注明出处)</h4><hr>
<p>  最近做了一个项目，老板要求菜单栏要有朋友印象那种效果，要是那种滑动的菜单，最好是仿照网易新闻首页的那种滑动的菜单。<br>  本来我是自己封装一个菜单栏的，想了一下。上面滑动的菜单用一个scrollview，scrollview上面设置几个固定的按钮，监听页面的滑动，每次换一个页面的时候，按钮的背景颜色，字体大小以及颜色进行改变达到那种显著的切换效果。下面切换的菜单就用一个scrollview上面在覆盖一层三个tableview，scrollview是用来控制横向滑动的，就是用图片轮播器的概念和tableview相结合 用tableview的tag属性来切换按钮和界面 最后实现这种效果。<br>  后来一直就是用的自己封装的这个菜单控件。感觉自己萌萌哒。可是后来遇到一个问题，我写的空间耦合度实在是太低了，封装的太差，导致代码很难重用。最终要的一点是，我只用了一个控制器来实现这所有的内容。啊。。后来我用了Bmob的云数据库，以及李明杰老师的MJRefrsh.操蛋的一件事情发生了。我的tableview卡顿到爆 几个tableview每次reload的时候我向左滑动的效果就变得极差，真是气死我了。</p>
<p>  后来我发现怎么优化都必须解决这个controller的MVC中的C占的比重过多的问题.一咬牙一跺脚，决定放弃自己封装的菜单空间，改去拥抱大神们封装的空间，看看有没有什么优秀的第三库可以使用或者可以借鉴一下设计模式。果不其然，让我在code4app里面找到一个最近才上传的十分优秀的一个demo，可以说是一个第三方库，简直是太棒了<br>  分享一下网址<br>  <a href="http://code4app.com/thread-8061-1-1.html" target="_blank" rel="external">超级干货仿网易</a>;</p>
<p>  详细解析<br>  code4app的帖子上已经介绍的很清楚了 但是我现在主要是想纪录一下我修改这个库的过程 鉴于自己的神记忆能力与理解能力<br>  先贴一下文件列表<br>  <img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-06-21%20%E4%B8%8A%E5%8D%889.57.02.png" alt=""></p>
<h4 id="UIView-ZJFrame"><a href="#UIView-ZJFrame" class="headerlink" title="UIView+ZJFrame"></a>UIView+ZJFrame</h4><p>  这个是用来设置每一个view的长宽高的 倒时候取出来的时候会很方便 这里就不想详细介绍了 作者的思路还是很清楚的</p>
<h4 id="UIViewController-ZJScrollPageController"><a href="#UIViewController-ZJScrollPageController" class="headerlink" title="UIViewController+ZJScrollPageController"></a>UIViewController+ZJScrollPageController</h4><p>  这个是描写父控制器与子控制器的 如头文件所说 方便每个子控制页面直接获取父控制器的 已经父子控制器进行一些操作 因为菜单下面的view作者是单独封装成一个一个控制器的 这有一个好处 每一个控制器都有自己的生命周期 以至于控制界面的时候我们可以在界面开始之前 开始之后 完全加载之后做一些很多内存啊 还是数据初始化的加载 这也是我选择使用这个第三方空间来优化我自己的menu的主要的一个原因<br>  这里面还使用了iOS界的一个黑模仿runtime哈哈哈<br>  不过这里面 以我现在的水平来说 还是没有办法定制的</p>
<h4 id="ZJContentView"><a href="#ZJContentView" class="headerlink" title="ZJContentView"></a>ZJContentView</h4><p>  这个主要是对子控制器的页面刷新 还有滚动速度调整 主要还是建立一个父控制器和子控制之间的关系 用了一个CollectionView的布局 使用weak避免页面循环引用 处理重用和内容显示的问题 我的业务暂时还没涉及到这部分 所以可能说寥寥数语带过</p>
<h4 id="ZJCustomLabel"><a href="#ZJCustomLabel" class="headerlink" title="ZJCustomLabel"></a>ZJCustomLabel</h4><p>  如题 定制了一个特定的label</p>
<h4 id="ZJSegmentStyle-以及-ZJScrollSegmentView"><a href="#ZJSegmentStyle-以及-ZJScrollSegmentView" class="headerlink" title="ZJSegmentStyle 以及 ZJScrollSegmentView"></a>ZJSegmentStyle 以及 ZJScrollSegmentView</h4><p>  前两个文件就直接带过吧 我主要研读的是接下来两段的代码<br>  <img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-06-21%20%E4%B8%8A%E5%8D%8810.13.27.png" alt=""><br>  <img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-06-21%20%E4%B8%8A%E5%8D%8810.10.58.png" alt=""><br>  我先从style这个文件开始 这个是用来设置菜单来高度的 作者的注释很全 提供了很多借口 很方便 代码的重用以及定制<br>  （我个人觉得封装第三方库的话 真是一个很棒的事情 你把所有的参数都抽出来 然后每次调用的时候 重新定义一下就可以了 @property就是 Obj里面一个很典型的设置公共参数的东西 不想其他别种的语言 Obj有一个特性 就是所有的参数以及变量都是私有的 相当于java里面的private 我们不能够很好的去调用一个参数 只有把它放在外面的 用property来实现接口 设置的时候还要考虑好究竟是strong 还是 weak 是assign还是copy抑或是retain 当然大多数时候我们需要再多加一个设置nonatomic来保证这个参数是线程安全的 （之后很少情况下会遇到atomic来定义 好像是在线程锁这方面会使用到 不过我暂时还没有使用过）</p>
<p>  这个是来设置覆盖 （下划线）的UI 以及各个动态获取并get到label长度的主要文件</p>
<p>  作者已经在头文件写的很详细了 我们每次使用的时候只需要直接导入头文件 实例化之后设置就好了</p>
<p>  但是我要投诉一下 反映一下这个空间的不足与缺点</p>
<p>  1.我每次想到定制菜单栏的UI的时候 有的时候对每一个title的逻辑像素点左边有固定要求的时候 我是设置不了的<br>  我需要去ZJScrollSegmentView这个文件里面 找到一个<code>setUpLabelsPosition</code>的方法来重新通过用数学计算的方法来定制页面<br>  所以我在ZJSegmentStyle的头文件之中加了一个插座接口<code>XYzuobiao</code> 如果我在一个工程中有多个地方需要调用这个中间的时候 每次调用的时候我的xy坐标以及大小 覆盖范围 颜色是要去不一样的 所以多一个便来来判断是哪一个<br>  我在这里进行自定义的方式通过公式来计算的 第一个坐标是可以固定的 用titlex titley titlew titleh 来进行设置 然后用forin循环来loop对title进行遍历 index＋＋ 接下来的坐标就是更改x的坐标了 延伸一下 这里面我们还可以来设置一下 这样的话 哈哈 还可以进行垂直方向的甚至于斜方向的定义<br>  <img src="http://7xs3ih.com1.z0.glb.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202016-06-21%20%E4%B8%8A%E5%8D%8810.24.59.png" alt=""><br>  2.当你以为更改结束title的坐标之后就结束了 你就错了 这个控件主要是通过label的长度来进行覆盖或者下划线的长度 所以更改万title的坐标还没完 你还要去更改一下覆盖或者是下滑线的初始坐标<br>  更改覆盖初始坐标的方法<code>setupScrollLineAndCover</code>里面有这么一行<code>coverX = (firstLabel.zj_width - coverW) * 0.5;</code>你可以在这个后面加个数值</p>
<p>  3.我个人觉得他这个控件根据label的长度来进行移动 渐变 是不错 但是这个空间的宽度是不是有一点太直男癌后期患者了 我觉得不能够仅仅根据label长度来进行封装 于是我找了半天怎么更改阴影的长度<br>  代码太多看起来果然有一种日了🐶的感觉 不过好在还是让我给找到了 在方法<code>setupTitles</code>里面有一句<code>[self.titleWidths addObject:@(bound.size.width)];</code>当你想要使用的时候 你只需更改成这样<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  CGFloat labelwidth =bounds.size.width+30;</span><br><span class="line">[self.titleWidths addObject:@(labelwidth)];</span><br></pre></td></tr></table></figure></p>
<p>  就可以了</p>
<p>  4.再说一个很坑的东西吧 我个人觉得作者没有优化好的地方 当我想要修改这个菜单的背景颜色的时候 日🐶的事情出现了 竟然在style里面没有接口 果然不能够愉快的玩耍了啊 不过后来我奇思妙想 然后就在 “setupUI” 这个方法里面直接加拉一条<code>_scrollView.backgroundColor = [UIColor colorWithRed:55.0/255.0 green:67.0/255.0 blue:81.0/255.0 alpha:1];</code><br>  愉快的搞定了 不过好像不是在这边改的 😂 先改了以后再修改吧 老板催的很急啊</p>
<h3 id="记录一下修改的小细节-希望以后重用的时候能够使用到"><a href="#记录一下修改的小细节-希望以后重用的时候能够使用到" class="headerlink" title="记录一下修改的小细节 希望以后重用的时候能够使用到"></a>记录一下修改的小细节 希望以后重用的时候能够使用到</h3>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/第三方库学习使用/">-第三方库学习使用</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-关于iOS图片压缩相关" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/11/关于iOS图片压缩相关/" class="article-date">
  	<time datetime="2016-06-11T02:06:37.000Z" itemprop="datePublished">2016-06-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/11/关于iOS图片压缩相关/">关于iOS图片压缩相关</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>all by CherryWang 转载请声明出处<br>最近有做到用户系统这方面的东西，就遇上了压缩图这个问题，目前处理的问题是用户头像的问题<br>头像直接上传的只保存一份的话。每一次用户使用的时候就回加载原图，烧流量而且会很卡顿。为了解决这个问题，我们通过一个压缩图的算法来实现在本地生成压缩图，然后上传云端的功能。<br>本来是打算直接上传图片到服务器的，可惜的是我用的是bmob的服务器，它在2016年之后的版本都不支持请求缩略图这个功能了，心好累。后来打算用javascripe重新写一份云端的逻辑的，结果bug太多，不会的东西还是不要强行装逼的比较好。<br>之后又打算再集成一个七牛sdk，再把所有的图片都放在七牛的服务器上面，后来想一想七牛那迷一般的文档，就放弃了😂。<br>我打算现在客户端先生成两份图 上传的时候上传两份图，后期再做朋友圈或者朋友印象这部分功能的时候在集成一下七牛的环境好了。</p>
<h2 id="吐槽一下-这真是一个多元化API-and-快速开发的时代啊😂"><a href="#吐槽一下-这真是一个多元化API-and-快速开发的时代啊😂" class="headerlink" title="吐槽一下 这真是一个多元化API and 快速开发的时代啊😂"></a>吐槽一下 这真是一个多元化API and 快速开发的时代啊😂</h2><p>言归正传</p>
<h3 id="做图片的压缩图的两种方式"><a href="#做图片的压缩图的两种方式" class="headerlink" title="做图片的压缩图的两种方式"></a>做图片的压缩图的两种方式</h3><p>第一种就是压，就是降低清晰度，但是图片的尺寸不变，像素数不变<br>第二种就是缩，把图片的尺寸变小，长宽减少了，像素数也就减少了，同时文件的体积也减小了</p>
<h4 id="第一种“压”—-压缩图片质量"><a href="#第一种“压”—-压缩图片质量" class="headerlink" title="第一种“压”—-压缩图片质量"></a>第一种“压”—-压缩图片质量</h4><p>压缩图片质量有两种形式（其实是一样的）<br>1.第一种<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">float kCompressionQuality = 0.3; //这个是压缩的比例</span><br><span class="line">  NSData *photo = UIImageJPEGRepresentation(UIImage, kCompressionQuality);</span><br></pre></td></tr></table></figure></p>
<p>2.第二种</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+(UIImage *)reduceImage:(UIImage *)image percent:(float)percent</span><br><span class="line">&#123;</span><br><span class="line">  NSData *imageData = UIImageJPEGRepresentation(image, percent);</span><br><span class="line">  UIImage *newImage = [UIImage imageWithData:imageData];</span><br><span class="line">  return newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="第二种“缩”—-减小图片尺寸"><a href="#第二种“缩”—-减小图片尺寸" class="headerlink" title="第二种“缩”—-减小图片尺寸"></a>第二种“缩”—-减小图片尺寸</h4><p>减小图片尺寸呢 有两种不同的减小 第一种就是给定尺寸来减小 第二种就是等比例减小<br>废话不多少 直接上代码<br>1.给定尺寸减小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-(UIImage *)scaleToSize:(UIImage *)aImage size:(CGSize)size&#123;</span><br><span class="line">    //获取当前图片的尺寸</span><br><span class="line">    UIGraphicsBeginImageContext(size);</span><br><span class="line">    //绘制出新图片(新尺寸)</span><br><span class="line">    [aImage drawInRect:CGRectMake(0, 0, size.width, size.height)];</span><br><span class="line">    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    //结束绘制</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    return newImage;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>2.等比例减小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">/等比例压缩</span><br><span class="line">-(UIImage *)oldImage:(UIImage *)oldImage toSize:(CGSize)size&#123;</span><br><span class="line"></span><br><span class="line">    UIImage *newImage = nil;//新照片对象</span><br><span class="line">    CGSize theSize = oldImage.size;//压缩前图片size</span><br><span class="line"></span><br><span class="line">    CGFloat width = theSize.width; //压缩前图片width</span><br><span class="line">    CGFloat height = theSize.height;//压缩前图片height</span><br><span class="line"></span><br><span class="line">    CGFloat newWidth = size.width; //压缩后图片width</span><br><span class="line">    CGFloat newHeight = size.height;//压缩后图片height</span><br><span class="line"></span><br><span class="line">    CGFloat scaleFactor = 0.0;//初值</span><br><span class="line"></span><br><span class="line">    CGFloat toWidth = newWidth;//压缩后图片width</span><br><span class="line">    CGFloat toHeight = newHeight;//压缩后图片height</span><br><span class="line"></span><br><span class="line">    CGPoint thumnailPoint = CGPointMake(0.0, 0.0);//给初值</span><br><span class="line"></span><br><span class="line">    if (CGSizeEqualToSize(theSize, size) == NO) &#123;</span><br><span class="line">        //判断是不是已经满足 theSize = size 要求</span><br><span class="line"></span><br><span class="line">        CGFloat widthFac = newWidth/width;</span><br><span class="line">        CGFloat heithrFac = newHeight/height;</span><br><span class="line">        if (widthFac &gt; heithrFac) &#123;</span><br><span class="line">            scaleFactor = widthFac;</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            scaleFactor = heithrFac;</span><br><span class="line">        &#125;</span><br><span class="line">        //不满足做等比例缩小处理</span><br><span class="line">        toWidth = width *scaleFactor;</span><br><span class="line">        toHeight = height *scaleFactor;</span><br><span class="line"></span><br><span class="line">        if (widthFac &gt; heithrFac) &#123;</span><br><span class="line">            thumnailPoint.y = (newHeight - toHeight)* 0.5;</span><br><span class="line">        &#125;else if (widthFac &lt; heithrFac)&#123;</span><br><span class="line">            thumnailPoint.x = (newWidth - toWidth)* 0.5;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //创建context,并将其设置为正在使用的context</span><br><span class="line">    UIGraphicsBeginImageContext(size);</span><br><span class="line">    CGRect thumbnailRect  = CGRectZero;</span><br><span class="line">    thumbnailRect.origin = thumnailPoint;</span><br><span class="line">    thumbnailRect.size.width = toWidth;</span><br><span class="line">    thumbnailRect.size.height = toHeight;</span><br><span class="line"></span><br><span class="line">    //绘制出图片(大小已经改变)</span><br><span class="line">    [oldImage drawInRect:thumbnailRect];</span><br><span class="line"></span><br><span class="line">    newImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line"></span><br><span class="line">    //结果判断</span><br><span class="line">    if (newImage == nil) &#123;</span><br><span class="line">        [NSException exceptionWithName:@&quot;提示&quot; reason:@&quot;Error:image scale fail&quot; userInfo:nil];</span><br><span class="line">    &#125;</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    return newImage;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(UIImage *) imageCompressForWidth:(UIImage *)sourceImage targetWidth:(CGFloat)defineWidth&#123;</span><br><span class="line"></span><br><span class="line">    UIImage *newImage = nil;</span><br><span class="line"></span><br><span class="line">    CGSize imageSize = sourceImage.size;</span><br><span class="line"></span><br><span class="line">    CGFloat width = imageSize.width;</span><br><span class="line">    CGFloat height = imageSize.height;</span><br><span class="line"></span><br><span class="line">    CGFloat targetWidth = defineWidth;</span><br><span class="line">    CGFloat targetHeight = height / (width / targetWidth);</span><br><span class="line">    CGSize size = CGSizeMake(targetWidth, targetHeight);</span><br><span class="line">    CGFloat scaleFactor = 0.0;</span><br><span class="line"></span><br><span class="line">    CGFloat scaledWidth = targetWidth;</span><br><span class="line">    CGFloat scaledHeight = targetHeight;</span><br><span class="line"></span><br><span class="line">    CGPoint thumbnailPoint = CGPointMake(0.0, 0.0);</span><br><span class="line"></span><br><span class="line">    if(CGSizeEqualToSize(imageSize, size) == NO)&#123;</span><br><span class="line">        CGFloat widthFactor = targetWidth / width;</span><br><span class="line">        CGFloat heightFactor = targetHeight / height;</span><br><span class="line">        if(widthFactor &gt; heightFactor)&#123;</span><br><span class="line">            scaleFactor = widthFactor;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            scaleFactor = heightFactor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        scaledWidth = width * scaleFactor;</span><br><span class="line">        scaledHeight = height * scaleFactor;</span><br><span class="line">        if(widthFactor &gt; heightFactor)&#123;</span><br><span class="line">            thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5;</span><br><span class="line">        &#125;else if(widthFactor &lt; heightFactor)&#123;</span><br><span class="line">            thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    UIGraphicsBeginImageContext(size);</span><br><span class="line">    CGRect thumbnailRect = CGRectZero;</span><br><span class="line">    thumbnailRect.origin = thumbnailPoint;</span><br><span class="line">    thumbnailRect.size.width = scaledWidth;</span><br><span class="line">    thumbnailRect.size.height = scaledHeight;</span><br><span class="line"></span><br><span class="line">    [sourceImage drawInRect:thumbnailRect];</span><br><span class="line"></span><br><span class="line">    newImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    if(newImage == nil)&#123;</span><br><span class="line">        NSLog(@&quot;scale image fail&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    return newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就先介绍到这里 有什么问题可以问我</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS页面优化相关/">-iOS页面优化相关</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS中BitCode的介绍和配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/02/iOS中BitCode的介绍和配置/" class="article-date">
  	<time datetime="2016-06-02T12:15:52.000Z" itemprop="datePublished">2016-06-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/02/iOS中BitCode的介绍和配置/">iOS中BitCode的介绍和配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天在一个iOS培训网站上看到一篇关于第三方库不包含bitcode就会报错的文章，感觉剖析得很详细，分享出来，希望可以对iOS初入门者有所帮助。下面我们就一起来看看吧。</p>
<p>用Xcode 7 beta 3在真机(iOS 8.3)上运行一下工程，结果发现工程编译不过。看了下问题，报的是以下错误：</p>
<p>ld: ‘/Users/<strong>/Framework/SDKs/PolymerPay/Library/mobStat/lib</strong>SDK.a(**ForSDK.o)’does not contain bitcode. You must rebuild it with bitcode enabled (Xcodesetting ENABLE_BITCODE), obtain an updated library from the vendor, or disablebitcode for this target. for architecture arm64</p>
<p>得到的信息是引入的一个第三方库不包含bitcode。</p>
<p>Bitcode是个什么鬼？</p>
<p>查阅了一下官方文档，在App</p>
<p>Distribution Guide–App Thinning (iOS, watchOS)一节中，找到了下面这样一个定义：</p>
<p>Bitcode is an intermediate representationof a compiled program. Apps you upload to iTunes Connect that contain bitcodewill be compiled and linked on the App Store. Including bitcode will allowApple to re-optimize your app binary in the future without the need to submit anew version of your app to the store.</p>
<p>说的是bitcode是被编译程序的一种中间形式的代码。包含bitcode配置的程序将会在App store上被编译和链接。bitcode允许苹果在后期重新优化程序的二进制文件，而不需要重新提交一个新的版本到App store上。</p>
<p>而在What’s New in Xcode-New Features in Xcode 7中，还有一段如下的描述：</p>
<p>Bitcode. When you archive for submission tothe App Store, Xcode will compile your app into an intermediate representation.The App Store will then compile the bitcode down into the 64 or 32 bitexecutables as necessary.</p>
<p>当提交程序到App store上时，Xcode会将程序编译为一个中间表现形式(bitcode)。然后App store会再将这个botcode编译为可执行的64位或32位程序。</p>
<p>再看看这两段描述，都是放在App Thinning(App瘦身)一节中，可以看出其与包的优化有关了。</p>
<p>Bitcode配置</p>
<p>在上面的错误提示中，提到了如何处理我们遇到的问题：</p>
<p>You must rebuild it with bitcode enabled(Xcode setting ENABLE_BITCODE), obtain an updated library from the vendor, ordisable bitcode for this target. for architecture arm64</p>
<p>要么让第三方库支持，要么关闭target的bitcode选项。</p>
<p>实际上，在Xcode 7中，我们新建一个iOS程序时，bitcode选项默认是设置为YES的。我们可以在”Build Settings”-&gt;”Enable Bitcode”选项中看到这个设置。不过，我们现在需要考虑的是三个平台：iOS，Mac OS，watchOS。</p>
<p>对于iOS，bitcode是可选的；对于watchOS，bitcode是必须的；而Mac OS是不支持bitcode。</p>
<p>如果我们开启了bitcode，在提交包时，下面这个界面也会有个bitcode选项：</p>
<p>所以，如果我们的工程需要支持bitcode，则必要要求所有引入的第三方库都支持bitcode。</p>
<p>通过本文对bitcode的概念及配置情况的简要介绍，希望iOS开发人员在工程运行中遇到类似的情况，可以根据上文的介绍更有效的找到原因并及时处理。</p>
<p>原文链接：<a href="http://www.jianshu.com/p/3e1b4e2d06c6" target="_blank" rel="external">http://www.jianshu.com/p/3e1b4e2d06c6</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/iOS小细节/">-iOS小细节</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-storyboard使用的一些坑" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/29/storyboard使用的一些坑/" class="article-date">
  	<time datetime="2016-05-29T06:11:46.000Z" itemprop="datePublished">2016-05-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/storyboard使用的一些坑/">storyboard使用的一些坑</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近使用storyboard进行了一系列的操作对于我这种手法不娴熟的人简直痛苦到窒息<br>不过我个人还是主推使用storyboard的，因为大势所趋，虽然只使用纯代码来构建布局的话耦合性会高一点。但是这个没有storyboard这种东西，很难理解一个产品的构架与结构啊<br>下面记述我在storyboard上面遇上的一些小坑，希望以后自己能够警醒，也希望这些能够帮助别人</p>
<h3 id="设置rootViewController的坑"><a href="#设置rootViewController的坑" class="headerlink" title="设置rootViewController的坑"></a>设置rootViewController的坑</h3><p>  有的时候我们用storyboard来实现一些页面的跳转，刚开始的时候想我就不会先去用kvc的模式去creat class所以这个时候会遇到一个问题，你在storyboard里面创建viewcontroller没有对应的实例类，当你需要通过带来来进行交互的时候，就会很困难。<br>说一下我的个人经历<br>  最近我个人做到bmob的注册登录的模块的时候，需要加一条逻辑。<br>  如果不是第一次使用这个app，在此之前已经注册并登录过，就跳过登录注册的界面<br>。。。。。<br>  这个看起来很简单<br>  只需要在appdelegate里面加一条逻辑 取出磁盘中的当前用户，加一个判断</p>
<pre><code>  `` BmobUser *bUser = [BmobUser getCurrentUser];
if (bUser) {

}else{

}
  ``
</code></pre><p>  我觉得这个时候我直接实例一个类 然后在self.window.rootViewController就可以了对吧<br>  然后我就被自己坑了<br>  你在root tabbar控制器的时候要这样写啊<br>    先把你的tabbar 的子rootviewcontroller里面加一个identifer<br>    然后在appdelegate里面实例化一个storyboard<br>    再把storyboard里面的控制器给取出来<br>    又因为是tabbar<br>    所以你要把tabbar下面每一个子rootviewcontroller实例一下<br>    然后存到一个数组里面<br>    然后显示tabbar加数组</p>
<pre><code>不废话了
代码如下
    ``        
    //进行操作
    //取出sb
    UIStoryboard *sb = [UIStoryboard storyboardWithName:@&quot;Main&quot; bundle:[NSBundle mainBundle]];
    _tabBarController =[[UITabBarController alloc]init];

    UINavigationController *nav =[sb instantiateViewControllerWithIdentifier:@&quot;tabController1&quot;];
    UIViewController *tabbar2 = [sb instantiateViewControllerWithIdentifier:@&quot;tabController2&quot;];
    UIViewController *tabbar3 =[sb instantiateViewControllerWithIdentifier:@&quot;tabController3&quot;];
    UIViewController *tabbar4 = [sb  instantiateViewControllerWithIdentifier:@&quot;tabController4&quot;];

    NSArray *controllers = [NSArray arrayWithObjects:nav, tabbar2,tabbar3,tabbar4, nil];
    _tabBarController.viewControllers = controllers;
    self.window.rootViewController = _tabBarController;

    self.window.rootViewController = self.tabBarController;
    ``
</code></pre><h3 id="页面跳转的坑"><a href="#页面跳转的坑" class="headerlink" title="页面跳转的坑"></a>页面跳转的坑</h3><p>storyboard最好的东西没有只有就是每一个东西都可以加identifer<br>haha<br>尤其是跳转页面的时候<br>你用segue跳转的时候判断一下identifer就好啦</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storyboard/">-storyboard</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 BadCodeLu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>